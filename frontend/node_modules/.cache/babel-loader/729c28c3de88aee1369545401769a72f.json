{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.cloneWindow = exports.DocumentCloner = undefined;\n\nvar _slicedToArray = function () {\n  function sliceIterator(arr, i) {\n    var _arr = [];\n    var _n = true;\n    var _d = false;\n    var _e = undefined;\n\n    try {\n      for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n        _arr.push(_s.value);\n\n        if (i && _arr.length === i) break;\n      }\n    } catch (err) {\n      _d = true;\n      _e = err;\n    } finally {\n      try {\n        if (!_n && _i[\"return\"]) _i[\"return\"]();\n      } finally {\n        if (_d) throw _e;\n      }\n    }\n\n    return _arr;\n  }\n\n  return function (arr, i) {\n    if (Array.isArray(arr)) {\n      return arr;\n    } else if (Symbol.iterator in Object(arr)) {\n      return sliceIterator(arr, i);\n    } else {\n      throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n    }\n  };\n}();\n\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nvar _Bounds = require('./Bounds');\n\nvar _Proxy = require('./Proxy');\n\nvar _ResourceLoader = require('./ResourceLoader');\n\nvar _ResourceLoader2 = _interopRequireDefault(_ResourceLoader);\n\nvar _Util = require('./Util');\n\nvar _background = require('./parsing/background');\n\nvar _CanvasRenderer = require('./renderer/CanvasRenderer');\n\nvar _CanvasRenderer2 = _interopRequireDefault(_CanvasRenderer);\n\nvar _PseudoNodeContent = require('./PseudoNodeContent');\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nvar IGNORE_ATTRIBUTE = 'data-html2canvas-ignore';\n\nvar DocumentCloner = exports.DocumentCloner = function () {\n  function DocumentCloner(element, options, logger, copyInline, renderer) {\n    _classCallCheck(this, DocumentCloner);\n\n    this.referenceElement = element;\n    this.scrolledElements = [];\n    this.copyStyles = copyInline;\n    this.inlineImages = copyInline;\n    this.logger = logger;\n    this.options = options;\n    this.renderer = renderer;\n    this.resourceLoader = new _ResourceLoader2.default(options, logger, window);\n    this.pseudoContentData = {\n      counters: {},\n      quoteDepth: 0\n    }; // $FlowFixMe\n\n    this.documentElement = this.cloneNode(element.ownerDocument.documentElement);\n  }\n\n  _createClass(DocumentCloner, [{\n    key: 'inlineAllImages',\n    value: function inlineAllImages(node) {\n      var _this = this;\n\n      if (this.inlineImages && node) {\n        var style = node.style;\n        Promise.all((0, _background.parseBackgroundImage)(style.backgroundImage).map(function (backgroundImage) {\n          if (backgroundImage.method === 'url') {\n            return _this.resourceLoader.inlineImage(backgroundImage.args[0]).then(function (img) {\n              return img && typeof img.src === 'string' ? 'url(\"' + img.src + '\")' : 'none';\n            }).catch(function (e) {\n              if (process.env.NODE_ENV !== 'production') {\n                _this.logger.log('Unable to load image', e);\n              }\n            });\n          }\n\n          return Promise.resolve('' + backgroundImage.prefix + backgroundImage.method + '(' + backgroundImage.args.join(',') + ')');\n        })).then(function (backgroundImages) {\n          if (backgroundImages.length > 1) {\n            // TODO Multiple backgrounds somehow broken in Chrome\n            style.backgroundColor = '';\n          }\n\n          style.backgroundImage = backgroundImages.join(',');\n        });\n\n        if (node instanceof HTMLImageElement) {\n          this.resourceLoader.inlineImage(node.src).then(function (img) {\n            if (img && node instanceof HTMLImageElement && node.parentNode) {\n              var parentNode = node.parentNode;\n              var clonedChild = (0, _Util.copyCSSStyles)(node.style, img.cloneNode(false));\n              parentNode.replaceChild(clonedChild, node);\n            }\n          }).catch(function (e) {\n            if (process.env.NODE_ENV !== 'production') {\n              _this.logger.log('Unable to load image', e);\n            }\n          });\n        }\n      }\n    }\n  }, {\n    key: 'inlineFonts',\n    value: function inlineFonts(document) {\n      var _this2 = this;\n\n      return Promise.all(Array.from(document.styleSheets).map(function (sheet) {\n        if (sheet.href) {\n          return fetch(sheet.href).then(function (res) {\n            return res.text();\n          }).then(function (text) {\n            return createStyleSheetFontsFromText(text, sheet.href);\n          }).catch(function (e) {\n            if (process.env.NODE_ENV !== 'production') {\n              _this2.logger.log('Unable to load stylesheet', e);\n            }\n\n            return [];\n          });\n        }\n\n        return getSheetFonts(sheet, document);\n      })).then(function (fonts) {\n        return fonts.reduce(function (acc, font) {\n          return acc.concat(font);\n        }, []);\n      }).then(function (fonts) {\n        return Promise.all(fonts.map(function (font) {\n          return fetch(font.formats[0].src).then(function (response) {\n            return response.blob();\n          }).then(function (blob) {\n            return new Promise(function (resolve, reject) {\n              var reader = new FileReader();\n              reader.onerror = reject;\n\n              reader.onload = function () {\n                // $FlowFixMe\n                var result = reader.result;\n                resolve(result);\n              };\n\n              reader.readAsDataURL(blob);\n            });\n          }).then(function (dataUri) {\n            font.fontFace.setProperty('src', 'url(\"' + dataUri + '\")');\n            return '@font-face {' + font.fontFace.cssText + ' ';\n          });\n        }));\n      }).then(function (fontCss) {\n        var style = document.createElement('style');\n        style.textContent = fontCss.join('\\n');\n\n        _this2.documentElement.appendChild(style);\n      });\n    }\n  }, {\n    key: 'createElementClone',\n    value: function createElementClone(node) {\n      var _this3 = this;\n\n      if (this.copyStyles && node instanceof HTMLCanvasElement) {\n        var img = node.ownerDocument.createElement('img');\n\n        try {\n          img.src = node.toDataURL();\n          return img;\n        } catch (e) {\n          if (process.env.NODE_ENV !== 'production') {\n            this.logger.log('Unable to clone canvas contents, canvas is tainted');\n          }\n        }\n      }\n\n      if (node instanceof HTMLIFrameElement) {\n        var tempIframe = node.cloneNode(false);\n        var iframeKey = generateIframeKey();\n        tempIframe.setAttribute('data-html2canvas-internal-iframe-key', iframeKey);\n\n        var _parseBounds = (0, _Bounds.parseBounds)(node, 0, 0),\n            width = _parseBounds.width,\n            height = _parseBounds.height;\n\n        this.resourceLoader.cache[iframeKey] = getIframeDocumentElement(node, this.options).then(function (documentElement) {\n          return _this3.renderer(documentElement, {\n            async: _this3.options.async,\n            allowTaint: _this3.options.allowTaint,\n            backgroundColor: '#ffffff',\n            canvas: null,\n            imageTimeout: _this3.options.imageTimeout,\n            logging: _this3.options.logging,\n            proxy: _this3.options.proxy,\n            removeContainer: _this3.options.removeContainer,\n            scale: _this3.options.scale,\n            foreignObjectRendering: _this3.options.foreignObjectRendering,\n            useCORS: _this3.options.useCORS,\n            target: new _CanvasRenderer2.default(),\n            width: width,\n            height: height,\n            x: 0,\n            y: 0,\n            windowWidth: documentElement.ownerDocument.defaultView.innerWidth,\n            windowHeight: documentElement.ownerDocument.defaultView.innerHeight,\n            scrollX: documentElement.ownerDocument.defaultView.pageXOffset,\n            scrollY: documentElement.ownerDocument.defaultView.pageYOffset\n          }, _this3.logger.child(iframeKey));\n        }).then(function (canvas) {\n          return new Promise(function (resolve, reject) {\n            var iframeCanvas = document.createElement('img');\n\n            iframeCanvas.onload = function () {\n              return resolve(canvas);\n            };\n\n            iframeCanvas.onerror = reject;\n            iframeCanvas.src = canvas.toDataURL();\n\n            if (tempIframe.parentNode) {\n              tempIframe.parentNode.replaceChild((0, _Util.copyCSSStyles)(node.ownerDocument.defaultView.getComputedStyle(node), iframeCanvas), tempIframe);\n            }\n          });\n        });\n        return tempIframe;\n      }\n\n      if (node instanceof HTMLStyleElement && node.sheet && node.sheet.cssRules) {\n        var css = [].slice.call(node.sheet.cssRules, 0).reduce(function (css, rule) {\n          try {\n            if (rule && rule.cssText) {\n              return css + rule.cssText;\n            }\n\n            return css;\n          } catch (err) {\n            _this3.logger.log('Unable to access cssText property', rule.name);\n\n            return css;\n          }\n        }, '');\n        var style = node.cloneNode(false);\n        style.textContent = css;\n        return style;\n      }\n\n      return node.cloneNode(false);\n    }\n  }, {\n    key: 'cloneNode',\n    value: function cloneNode(node) {\n      var clone = node.nodeType === Node.TEXT_NODE ? document.createTextNode(node.nodeValue) : this.createElementClone(node);\n      var window = node.ownerDocument.defaultView;\n      var style = node instanceof window.HTMLElement ? window.getComputedStyle(node) : null;\n      var styleBefore = node instanceof window.HTMLElement ? window.getComputedStyle(node, ':before') : null;\n      var styleAfter = node instanceof window.HTMLElement ? window.getComputedStyle(node, ':after') : null;\n\n      if (this.referenceElement === node && clone instanceof window.HTMLElement) {\n        this.clonedReferenceElement = clone;\n      }\n\n      if (clone instanceof window.HTMLBodyElement) {\n        createPseudoHideStyles(clone);\n      }\n\n      var counters = (0, _PseudoNodeContent.parseCounterReset)(style, this.pseudoContentData);\n      var contentBefore = (0, _PseudoNodeContent.resolvePseudoContent)(node, styleBefore, this.pseudoContentData);\n\n      for (var child = node.firstChild; child; child = child.nextSibling) {\n        if (child.nodeType !== Node.ELEMENT_NODE || child.nodeName !== 'SCRIPT' && // $FlowFixMe\n        !child.hasAttribute(IGNORE_ATTRIBUTE) && (typeof this.options.ignoreElements !== 'function' || // $FlowFixMe\n        !this.options.ignoreElements(child))) {\n          if (!this.copyStyles || child.nodeName !== 'STYLE') {\n            clone.appendChild(this.cloneNode(child));\n          }\n        }\n      }\n\n      var contentAfter = (0, _PseudoNodeContent.resolvePseudoContent)(node, styleAfter, this.pseudoContentData);\n      (0, _PseudoNodeContent.popCounters)(counters, this.pseudoContentData);\n\n      if (node instanceof window.HTMLElement && clone instanceof window.HTMLElement) {\n        if (styleBefore) {\n          this.inlineAllImages(inlinePseudoElement(node, clone, styleBefore, contentBefore, PSEUDO_BEFORE));\n        }\n\n        if (styleAfter) {\n          this.inlineAllImages(inlinePseudoElement(node, clone, styleAfter, contentAfter, PSEUDO_AFTER));\n        }\n\n        if (style && this.copyStyles && !(node instanceof HTMLIFrameElement)) {\n          (0, _Util.copyCSSStyles)(style, clone);\n        }\n\n        this.inlineAllImages(clone);\n\n        if (node.scrollTop !== 0 || node.scrollLeft !== 0) {\n          this.scrolledElements.push([clone, node.scrollLeft, node.scrollTop]);\n        }\n\n        switch (node.nodeName) {\n          case 'CANVAS':\n            if (!this.copyStyles) {\n              cloneCanvasContents(node, clone);\n            }\n\n            break;\n\n          case 'TEXTAREA':\n          case 'SELECT':\n            clone.value = node.value;\n            break;\n        }\n      }\n\n      return clone;\n    }\n  }]);\n\n  return DocumentCloner;\n}();\n\nvar getSheetFonts = function getSheetFonts(sheet, document) {\n  // $FlowFixMe\n  return (sheet.cssRules ? Array.from(sheet.cssRules) : []).filter(function (rule) {\n    return rule.type === CSSRule.FONT_FACE_RULE;\n  }).map(function (rule) {\n    var src = (0, _background.parseBackgroundImage)(rule.style.getPropertyValue('src'));\n    var formats = [];\n\n    for (var i = 0; i < src.length; i++) {\n      if (src[i].method === 'url' && src[i + 1] && src[i + 1].method === 'format') {\n        var a = document.createElement('a');\n        a.href = src[i].args[0];\n\n        if (document.body) {\n          document.body.appendChild(a);\n        }\n\n        var font = {\n          src: a.href,\n          format: src[i + 1].args[0]\n        };\n        formats.push(font);\n      }\n    }\n\n    return {\n      // TODO select correct format for browser),\n      formats: formats.filter(function (font) {\n        return /^woff/i.test(font.format);\n      }),\n      fontFace: rule.style\n    };\n  }).filter(function (font) {\n    return font.formats.length;\n  });\n};\n\nvar createStyleSheetFontsFromText = function createStyleSheetFontsFromText(text, baseHref) {\n  var doc = document.implementation.createHTMLDocument('');\n  var base = document.createElement('base'); // $FlowFixMe\n\n  base.href = baseHref;\n  var style = document.createElement('style');\n  style.textContent = text;\n\n  if (doc.head) {\n    doc.head.appendChild(base);\n  }\n\n  if (doc.body) {\n    doc.body.appendChild(style);\n  }\n\n  return style.sheet ? getSheetFonts(style.sheet, doc) : [];\n};\n\nvar restoreOwnerScroll = function restoreOwnerScroll(ownerDocument, x, y) {\n  if (ownerDocument.defaultView && (x !== ownerDocument.defaultView.pageXOffset || y !== ownerDocument.defaultView.pageYOffset)) {\n    ownerDocument.defaultView.scrollTo(x, y);\n  }\n};\n\nvar cloneCanvasContents = function cloneCanvasContents(canvas, clonedCanvas) {\n  try {\n    if (clonedCanvas) {\n      clonedCanvas.width = canvas.width;\n      clonedCanvas.height = canvas.height;\n      var ctx = canvas.getContext('2d');\n      var clonedCtx = clonedCanvas.getContext('2d');\n\n      if (ctx) {\n        clonedCtx.putImageData(ctx.getImageData(0, 0, canvas.width, canvas.height), 0, 0);\n      } else {\n        clonedCtx.drawImage(canvas, 0, 0);\n      }\n    }\n  } catch (e) {}\n};\n\nvar inlinePseudoElement = function inlinePseudoElement(node, clone, style, contentItems, pseudoElt) {\n  if (!style || !style.content || style.content === 'none' || style.content === '-moz-alt-content' || style.display === 'none') {\n    return;\n  }\n\n  var anonymousReplacedElement = clone.ownerDocument.createElement('html2canvaspseudoelement');\n  (0, _Util.copyCSSStyles)(style, anonymousReplacedElement);\n\n  if (contentItems) {\n    var len = contentItems.length;\n\n    for (var i = 0; i < len; i++) {\n      var item = contentItems[i];\n\n      switch (item.type) {\n        case _PseudoNodeContent.PSEUDO_CONTENT_ITEM_TYPE.IMAGE:\n          var img = clone.ownerDocument.createElement('img');\n          img.src = (0, _background.parseBackgroundImage)('url(' + item.value + ')')[0].args[0];\n          img.style.opacity = '1';\n          anonymousReplacedElement.appendChild(img);\n          break;\n\n        case _PseudoNodeContent.PSEUDO_CONTENT_ITEM_TYPE.TEXT:\n          anonymousReplacedElement.appendChild(clone.ownerDocument.createTextNode(item.value));\n          break;\n      }\n    }\n  }\n\n  anonymousReplacedElement.className = PSEUDO_HIDE_ELEMENT_CLASS_BEFORE + ' ' + PSEUDO_HIDE_ELEMENT_CLASS_AFTER;\n  clone.className += pseudoElt === PSEUDO_BEFORE ? ' ' + PSEUDO_HIDE_ELEMENT_CLASS_BEFORE : ' ' + PSEUDO_HIDE_ELEMENT_CLASS_AFTER;\n\n  if (pseudoElt === PSEUDO_BEFORE) {\n    clone.insertBefore(anonymousReplacedElement, clone.firstChild);\n  } else {\n    clone.appendChild(anonymousReplacedElement);\n  }\n\n  return anonymousReplacedElement;\n};\n\nvar URL_REGEXP = /^url\\((.+)\\)$/i;\nvar PSEUDO_BEFORE = ':before';\nvar PSEUDO_AFTER = ':after';\nvar PSEUDO_HIDE_ELEMENT_CLASS_BEFORE = '___html2canvas___pseudoelement_before';\nvar PSEUDO_HIDE_ELEMENT_CLASS_AFTER = '___html2canvas___pseudoelement_after';\nvar PSEUDO_HIDE_ELEMENT_STYLE = '{\\n    content: \"\" !important;\\n    display: none !important;\\n}';\n\nvar createPseudoHideStyles = function createPseudoHideStyles(body) {\n  createStyles(body, '.' + PSEUDO_HIDE_ELEMENT_CLASS_BEFORE + PSEUDO_BEFORE + PSEUDO_HIDE_ELEMENT_STYLE + '\\n         .' + PSEUDO_HIDE_ELEMENT_CLASS_AFTER + PSEUDO_AFTER + PSEUDO_HIDE_ELEMENT_STYLE);\n};\n\nvar createStyles = function createStyles(body, styles) {\n  var style = body.ownerDocument.createElement('style');\n  style.innerHTML = styles;\n  body.appendChild(style);\n};\n\nvar initNode = function initNode(_ref) {\n  var _ref2 = _slicedToArray(_ref, 3),\n      element = _ref2[0],\n      x = _ref2[1],\n      y = _ref2[2];\n\n  element.scrollLeft = x;\n  element.scrollTop = y;\n};\n\nvar generateIframeKey = function generateIframeKey() {\n  return Math.ceil(Date.now() + Math.random() * 10000000).toString(16);\n};\n\nvar DATA_URI_REGEXP = /^data:text\\/(.+);(base64)?,(.*)$/i;\n\nvar getIframeDocumentElement = function getIframeDocumentElement(node, options) {\n  try {\n    return Promise.resolve(node.contentWindow.document.documentElement);\n  } catch (e) {\n    return options.proxy ? (0, _Proxy.Proxy)(node.src, options).then(function (html) {\n      var match = html.match(DATA_URI_REGEXP);\n\n      if (!match) {\n        return Promise.reject();\n      }\n\n      return match[2] === 'base64' ? window.atob(decodeURIComponent(match[3])) : decodeURIComponent(match[3]);\n    }).then(function (html) {\n      return createIframeContainer(node.ownerDocument, (0, _Bounds.parseBounds)(node, 0, 0)).then(function (cloneIframeContainer) {\n        var cloneWindow = cloneIframeContainer.contentWindow;\n        var documentClone = cloneWindow.document;\n        documentClone.open();\n        documentClone.write(html);\n        var iframeLoad = iframeLoader(cloneIframeContainer).then(function () {\n          return documentClone.documentElement;\n        });\n        documentClone.close();\n        return iframeLoad;\n      });\n    }) : Promise.reject();\n  }\n};\n\nvar createIframeContainer = function createIframeContainer(ownerDocument, bounds) {\n  var cloneIframeContainer = ownerDocument.createElement('iframe');\n  cloneIframeContainer.className = 'html2canvas-container';\n  cloneIframeContainer.style.visibility = 'hidden';\n  cloneIframeContainer.style.position = 'fixed';\n  cloneIframeContainer.style.left = '-10000px';\n  cloneIframeContainer.style.top = '0px';\n  cloneIframeContainer.style.border = '0';\n  cloneIframeContainer.width = bounds.width.toString();\n  cloneIframeContainer.height = bounds.height.toString();\n  cloneIframeContainer.scrolling = 'no'; // ios won't scroll without it\n\n  cloneIframeContainer.setAttribute(IGNORE_ATTRIBUTE, 'true');\n\n  if (!ownerDocument.body) {\n    return Promise.reject(process.env.NODE_ENV !== 'production' ? 'Body element not found in Document that is getting rendered' : '');\n  }\n\n  ownerDocument.body.appendChild(cloneIframeContainer);\n  return Promise.resolve(cloneIframeContainer);\n};\n\nvar iframeLoader = function iframeLoader(cloneIframeContainer) {\n  var cloneWindow = cloneIframeContainer.contentWindow;\n  var documentClone = cloneWindow.document;\n  return new Promise(function (resolve, reject) {\n    cloneWindow.onload = cloneIframeContainer.onload = documentClone.onreadystatechange = function () {\n      var interval = setInterval(function () {\n        if (documentClone.body.childNodes.length > 0 && documentClone.readyState === 'complete') {\n          clearInterval(interval);\n          resolve(cloneIframeContainer);\n        }\n      }, 50);\n    };\n  });\n};\n\nvar cloneWindow = exports.cloneWindow = function cloneWindow(ownerDocument, bounds, referenceElement, options, logger, renderer) {\n  var cloner = new DocumentCloner(referenceElement, options, logger, false, renderer);\n  var scrollX = ownerDocument.defaultView.pageXOffset;\n  var scrollY = ownerDocument.defaultView.pageYOffset;\n  return createIframeContainer(ownerDocument, bounds).then(function (cloneIframeContainer) {\n    var cloneWindow = cloneIframeContainer.contentWindow;\n    var documentClone = cloneWindow.document;\n    /* Chrome doesn't detect relative background-images assigned in inline <style> sheets when fetched through getComputedStyle\n         if window url is about:blank, we can assign the url to current by writing onto the document\n         */\n\n    var iframeLoad = iframeLoader(cloneIframeContainer).then(function () {\n      cloner.scrolledElements.forEach(initNode);\n      cloneWindow.scrollTo(bounds.left, bounds.top);\n\n      if (/(iPad|iPhone|iPod)/g.test(navigator.userAgent) && (cloneWindow.scrollY !== bounds.top || cloneWindow.scrollX !== bounds.left)) {\n        documentClone.documentElement.style.top = -bounds.top + 'px';\n        documentClone.documentElement.style.left = -bounds.left + 'px';\n        documentClone.documentElement.style.position = 'absolute';\n      }\n\n      var result = Promise.resolve([cloneIframeContainer, cloner.clonedReferenceElement, cloner.resourceLoader]);\n      var onclone = options.onclone;\n      return cloner.clonedReferenceElement instanceof cloneWindow.HTMLElement || cloner.clonedReferenceElement instanceof ownerDocument.defaultView.HTMLElement || cloner.clonedReferenceElement instanceof HTMLElement ? typeof onclone === 'function' ? Promise.resolve().then(function () {\n        return onclone(documentClone);\n      }).then(function () {\n        return result;\n      }) : result : Promise.reject(process.env.NODE_ENV !== 'production' ? 'Error finding the ' + referenceElement.nodeName + ' in the cloned document' : '');\n    });\n    documentClone.open();\n    documentClone.write(serializeDoctype(document.doctype) + '<html></html>'); // Chrome scrolls the parent document for some reason after the write to the cloned window???\n\n    restoreOwnerScroll(referenceElement.ownerDocument, scrollX, scrollY);\n    documentClone.replaceChild(documentClone.adoptNode(cloner.documentElement), documentClone.documentElement);\n    documentClone.close();\n    return iframeLoad;\n  });\n};\n\nvar serializeDoctype = function serializeDoctype(doctype) {\n  var str = '';\n\n  if (doctype) {\n    str += '<!DOCTYPE ';\n\n    if (doctype.name) {\n      str += doctype.name;\n    }\n\n    if (doctype.internalSubset) {\n      str += doctype.internalSubset;\n    }\n\n    if (doctype.publicId) {\n      str += '\"' + doctype.publicId + '\"';\n    }\n\n    if (doctype.systemId) {\n      str += '\"' + doctype.systemId + '\"';\n    }\n\n    str += '>';\n  }\n\n  return str;\n};","map":{"version":3,"sources":["/Users/ChathushkaRodrigo/Desktop/ITP Project/ZooMelaka-Management-System/frontend/node_modules/react-to-pdf/node_modules/html2canvas/dist/npm/Clone.js"],"names":["Object","defineProperty","exports","value","cloneWindow","DocumentCloner","undefined","_slicedToArray","sliceIterator","arr","i","_arr","_n","_d","_e","_i","Symbol","iterator","_s","next","done","push","length","err","Array","isArray","TypeError","_createClass","defineProperties","target","props","descriptor","enumerable","configurable","writable","key","Constructor","protoProps","staticProps","prototype","_Bounds","require","_Proxy","_ResourceLoader","_ResourceLoader2","_interopRequireDefault","_Util","_background","_CanvasRenderer","_CanvasRenderer2","_PseudoNodeContent","obj","__esModule","default","_classCallCheck","instance","IGNORE_ATTRIBUTE","element","options","logger","copyInline","renderer","referenceElement","scrolledElements","copyStyles","inlineImages","resourceLoader","window","pseudoContentData","counters","quoteDepth","documentElement","cloneNode","ownerDocument","inlineAllImages","node","_this","style","Promise","all","parseBackgroundImage","backgroundImage","map","method","inlineImage","args","then","img","src","catch","e","process","env","NODE_ENV","log","resolve","prefix","join","backgroundImages","backgroundColor","HTMLImageElement","parentNode","clonedChild","copyCSSStyles","replaceChild","inlineFonts","document","_this2","from","styleSheets","sheet","href","fetch","res","text","createStyleSheetFontsFromText","getSheetFonts","fonts","reduce","acc","font","concat","formats","response","blob","reject","reader","FileReader","onerror","onload","result","readAsDataURL","dataUri","fontFace","setProperty","cssText","fontCss","createElement","textContent","appendChild","createElementClone","_this3","HTMLCanvasElement","toDataURL","HTMLIFrameElement","tempIframe","iframeKey","generateIframeKey","setAttribute","_parseBounds","parseBounds","width","height","cache","getIframeDocumentElement","async","allowTaint","canvas","imageTimeout","logging","proxy","removeContainer","scale","foreignObjectRendering","useCORS","x","y","windowWidth","defaultView","innerWidth","windowHeight","innerHeight","scrollX","pageXOffset","scrollY","pageYOffset","child","iframeCanvas","getComputedStyle","HTMLStyleElement","cssRules","css","slice","call","rule","name","clone","nodeType","Node","TEXT_NODE","createTextNode","nodeValue","HTMLElement","styleBefore","styleAfter","clonedReferenceElement","HTMLBodyElement","createPseudoHideStyles","parseCounterReset","contentBefore","resolvePseudoContent","firstChild","nextSibling","ELEMENT_NODE","nodeName","hasAttribute","ignoreElements","contentAfter","popCounters","inlinePseudoElement","PSEUDO_BEFORE","PSEUDO_AFTER","scrollTop","scrollLeft","cloneCanvasContents","filter","type","CSSRule","FONT_FACE_RULE","getPropertyValue","a","body","format","test","baseHref","doc","implementation","createHTMLDocument","base","head","restoreOwnerScroll","scrollTo","clonedCanvas","ctx","getContext","clonedCtx","putImageData","getImageData","drawImage","contentItems","pseudoElt","content","display","anonymousReplacedElement","len","item","PSEUDO_CONTENT_ITEM_TYPE","IMAGE","opacity","TEXT","className","PSEUDO_HIDE_ELEMENT_CLASS_BEFORE","PSEUDO_HIDE_ELEMENT_CLASS_AFTER","insertBefore","URL_REGEXP","PSEUDO_HIDE_ELEMENT_STYLE","createStyles","styles","innerHTML","initNode","_ref","_ref2","Math","ceil","Date","now","random","toString","DATA_URI_REGEXP","contentWindow","Proxy","html","match","atob","decodeURIComponent","createIframeContainer","cloneIframeContainer","documentClone","open","write","iframeLoad","iframeLoader","close","bounds","visibility","position","left","top","border","scrolling","onreadystatechange","interval","setInterval","childNodes","readyState","clearInterval","cloner","forEach","navigator","userAgent","onclone","serializeDoctype","doctype","adoptNode","str","internalSubset","publicId","systemId"],"mappings":"AAAA;;AAEAA,MAAM,CAACC,cAAP,CAAsBC,OAAtB,EAA+B,YAA/B,EAA6C;AACzCC,EAAAA,KAAK,EAAE;AADkC,CAA7C;AAGAD,OAAO,CAACE,WAAR,GAAsBF,OAAO,CAACG,cAAR,GAAyBC,SAA/C;;AAEA,IAAIC,cAAc,GAAG,YAAY;AAAE,WAASC,aAAT,CAAuBC,GAAvB,EAA4BC,CAA5B,EAA+B;AAAE,QAAIC,IAAI,GAAG,EAAX;AAAe,QAAIC,EAAE,GAAG,IAAT;AAAe,QAAIC,EAAE,GAAG,KAAT;AAAgB,QAAIC,EAAE,GAAGR,SAAT;;AAAoB,QAAI;AAAE,WAAK,IAAIS,EAAE,GAAGN,GAAG,CAACO,MAAM,CAACC,QAAR,CAAH,EAAT,EAAiCC,EAAtC,EAA0C,EAAEN,EAAE,GAAG,CAACM,EAAE,GAAGH,EAAE,CAACI,IAAH,EAAN,EAAiBC,IAAxB,CAA1C,EAAyER,EAAE,GAAG,IAA9E,EAAoF;AAAED,QAAAA,IAAI,CAACU,IAAL,CAAUH,EAAE,CAACf,KAAb;;AAAqB,YAAIO,CAAC,IAAIC,IAAI,CAACW,MAAL,KAAgBZ,CAAzB,EAA4B;AAAQ;AAAE,KAAvJ,CAAwJ,OAAOa,GAAP,EAAY;AAAEV,MAAAA,EAAE,GAAG,IAAL;AAAWC,MAAAA,EAAE,GAAGS,GAAL;AAAW,KAA5L,SAAqM;AAAE,UAAI;AAAE,YAAI,CAACX,EAAD,IAAOG,EAAE,CAAC,QAAD,CAAb,EAAyBA,EAAE,CAAC,QAAD,CAAF;AAAiB,OAAhD,SAAyD;AAAE,YAAIF,EAAJ,EAAQ,MAAMC,EAAN;AAAW;AAAE;;AAAC,WAAOH,IAAP;AAAc;;AAAC,SAAO,UAAUF,GAAV,EAAeC,CAAf,EAAkB;AAAE,QAAIc,KAAK,CAACC,OAAN,CAAchB,GAAd,CAAJ,EAAwB;AAAE,aAAOA,GAAP;AAAa,KAAvC,MAA6C,IAAIO,MAAM,CAACC,QAAP,IAAmBjB,MAAM,CAACS,GAAD,CAA7B,EAAoC;AAAE,aAAOD,aAAa,CAACC,GAAD,EAAMC,CAAN,CAApB;AAA+B,KAArE,MAA2E;AAAE,YAAM,IAAIgB,SAAJ,CAAc,sDAAd,CAAN;AAA8E;AAAE,GAArO;AAAwO,CAAhoB,EAArB;;AAEA,IAAIC,YAAY,GAAG,YAAY;AAAE,WAASC,gBAAT,CAA0BC,MAA1B,EAAkCC,KAAlC,EAAyC;AAAE,SAAK,IAAIpB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGoB,KAAK,CAACR,MAA1B,EAAkCZ,CAAC,EAAnC,EAAuC;AAAE,UAAIqB,UAAU,GAAGD,KAAK,CAACpB,CAAD,CAAtB;AAA2BqB,MAAAA,UAAU,CAACC,UAAX,GAAwBD,UAAU,CAACC,UAAX,IAAyB,KAAjD;AAAwDD,MAAAA,UAAU,CAACE,YAAX,GAA0B,IAA1B;AAAgC,UAAI,WAAWF,UAAf,EAA2BA,UAAU,CAACG,QAAX,GAAsB,IAAtB;AAA4BlC,MAAAA,MAAM,CAACC,cAAP,CAAsB4B,MAAtB,EAA8BE,UAAU,CAACI,GAAzC,EAA8CJ,UAA9C;AAA4D;AAAE;;AAAC,SAAO,UAAUK,WAAV,EAAuBC,UAAvB,EAAmCC,WAAnC,EAAgD;AAAE,QAAID,UAAJ,EAAgBT,gBAAgB,CAACQ,WAAW,CAACG,SAAb,EAAwBF,UAAxB,CAAhB;AAAqD,QAAIC,WAAJ,EAAiBV,gBAAgB,CAACQ,WAAD,EAAcE,WAAd,CAAhB;AAA4C,WAAOF,WAAP;AAAqB,GAAhN;AAAmN,CAA9hB,EAAnB;;AAEA,IAAII,OAAO,GAAGC,OAAO,CAAC,UAAD,CAArB;;AAEA,IAAIC,MAAM,GAAGD,OAAO,CAAC,SAAD,CAApB;;AAEA,IAAIE,eAAe,GAAGF,OAAO,CAAC,kBAAD,CAA7B;;AAEA,IAAIG,gBAAgB,GAAGC,sBAAsB,CAACF,eAAD,CAA7C;;AAEA,IAAIG,KAAK,GAAGL,OAAO,CAAC,QAAD,CAAnB;;AAEA,IAAIM,WAAW,GAAGN,OAAO,CAAC,sBAAD,CAAzB;;AAEA,IAAIO,eAAe,GAAGP,OAAO,CAAC,2BAAD,CAA7B;;AAEA,IAAIQ,gBAAgB,GAAGJ,sBAAsB,CAACG,eAAD,CAA7C;;AAEA,IAAIE,kBAAkB,GAAGT,OAAO,CAAC,qBAAD,CAAhC;;AAEA,SAASI,sBAAT,CAAgCM,GAAhC,EAAqC;AAAE,SAAOA,GAAG,IAAIA,GAAG,CAACC,UAAX,GAAwBD,GAAxB,GAA8B;AAAEE,IAAAA,OAAO,EAAEF;AAAX,GAArC;AAAwD;;AAE/F,SAASG,eAAT,CAAyBC,QAAzB,EAAmCnB,WAAnC,EAAgD;AAAE,MAAI,EAAEmB,QAAQ,YAAYnB,WAAtB,CAAJ,EAAwC;AAAE,UAAM,IAAIV,SAAJ,CAAc,mCAAd,CAAN;AAA2D;AAAE;;AAEzJ,IAAI8B,gBAAgB,GAAG,yBAAvB;;AAEA,IAAInD,cAAc,GAAGH,OAAO,CAACG,cAAR,GAAyB,YAAY;AACtD,WAASA,cAAT,CAAwBoD,OAAxB,EAAiCC,OAAjC,EAA0CC,MAA1C,EAAkDC,UAAlD,EAA8DC,QAA9D,EAAwE;AACpEP,IAAAA,eAAe,CAAC,IAAD,EAAOjD,cAAP,CAAf;;AAEA,SAAKyD,gBAAL,GAAwBL,OAAxB;AACA,SAAKM,gBAAL,GAAwB,EAAxB;AACA,SAAKC,UAAL,GAAkBJ,UAAlB;AACA,SAAKK,YAAL,GAAoBL,UAApB;AACA,SAAKD,MAAL,GAAcA,MAAd;AACA,SAAKD,OAAL,GAAeA,OAAf;AACA,SAAKG,QAAL,GAAgBA,QAAhB;AACA,SAAKK,cAAL,GAAsB,IAAItB,gBAAgB,CAACS,OAArB,CAA6BK,OAA7B,EAAsCC,MAAtC,EAA8CQ,MAA9C,CAAtB;AACA,SAAKC,iBAAL,GAAyB;AACrBC,MAAAA,QAAQ,EAAE,EADW;AAErBC,MAAAA,UAAU,EAAE;AAFS,KAAzB,CAXoE,CAepE;;AACA,SAAKC,eAAL,GAAuB,KAAKC,SAAL,CAAef,OAAO,CAACgB,aAAR,CAAsBF,eAArC,CAAvB;AACH;;AAED5C,EAAAA,YAAY,CAACtB,cAAD,EAAiB,CAAC;AAC1B8B,IAAAA,GAAG,EAAE,iBADqB;AAE1BhC,IAAAA,KAAK,EAAE,SAASuE,eAAT,CAAyBC,IAAzB,EAA+B;AAClC,UAAIC,KAAK,GAAG,IAAZ;;AAEA,UAAI,KAAKX,YAAL,IAAqBU,IAAzB,EAA+B;AAC3B,YAAIE,KAAK,GAAGF,IAAI,CAACE,KAAjB;AACAC,QAAAA,OAAO,CAACC,GAAR,CAAY,CAAC,GAAGhC,WAAW,CAACiC,oBAAhB,EAAsCH,KAAK,CAACI,eAA5C,EAA6DC,GAA7D,CAAiE,UAAUD,eAAV,EAA2B;AACpG,cAAIA,eAAe,CAACE,MAAhB,KAA2B,KAA/B,EAAsC;AAClC,mBAAOP,KAAK,CAACV,cAAN,CAAqBkB,WAArB,CAAiCH,eAAe,CAACI,IAAhB,CAAqB,CAArB,CAAjC,EAA0DC,IAA1D,CAA+D,UAAUC,GAAV,EAAe;AACjF,qBAAOA,GAAG,IAAI,OAAOA,GAAG,CAACC,GAAX,KAAmB,QAA1B,GAAqC,UAAUD,GAAG,CAACC,GAAd,GAAoB,IAAzD,GAAgE,MAAvE;AACH,aAFM,EAEJC,KAFI,CAEE,UAAUC,CAAV,EAAa;AAClB,kBAAIC,OAAO,CAACC,GAAR,CAAYC,QAAZ,KAAyB,YAA7B,EAA2C;AACvCjB,gBAAAA,KAAK,CAACjB,MAAN,CAAamC,GAAb,CAAiB,sBAAjB,EAAyCJ,CAAzC;AACH;AACJ,aANM,CAAP;AAOH;;AACD,iBAAOZ,OAAO,CAACiB,OAAR,CAAgB,KAAKd,eAAe,CAACe,MAArB,GAA8Bf,eAAe,CAACE,MAA9C,GAAuD,GAAvD,GAA6DF,eAAe,CAACI,IAAhB,CAAqBY,IAArB,CAA0B,GAA1B,CAA7D,GAA8F,GAA9G,CAAP;AACH,SAXW,CAAZ,EAWIX,IAXJ,CAWS,UAAUY,gBAAV,EAA4B;AACjC,cAAIA,gBAAgB,CAAC5E,MAAjB,GAA0B,CAA9B,EAAiC;AAC7B;AACAuD,YAAAA,KAAK,CAACsB,eAAN,GAAwB,EAAxB;AACH;;AACDtB,UAAAA,KAAK,CAACI,eAAN,GAAwBiB,gBAAgB,CAACD,IAAjB,CAAsB,GAAtB,CAAxB;AACH,SAjBD;;AAmBA,YAAItB,IAAI,YAAYyB,gBAApB,EAAsC;AAClC,eAAKlC,cAAL,CAAoBkB,WAApB,CAAgCT,IAAI,CAACa,GAArC,EAA0CF,IAA1C,CAA+C,UAAUC,GAAV,EAAe;AAC1D,gBAAIA,GAAG,IAAIZ,IAAI,YAAYyB,gBAAvB,IAA2CzB,IAAI,CAAC0B,UAApD,EAAgE;AAC5D,kBAAIA,UAAU,GAAG1B,IAAI,CAAC0B,UAAtB;AACA,kBAAIC,WAAW,GAAG,CAAC,GAAGxD,KAAK,CAACyD,aAAV,EAAyB5B,IAAI,CAACE,KAA9B,EAAqCU,GAAG,CAACf,SAAJ,CAAc,KAAd,CAArC,CAAlB;AACA6B,cAAAA,UAAU,CAACG,YAAX,CAAwBF,WAAxB,EAAqC3B,IAArC;AACH;AACJ,WAND,EAMGc,KANH,CAMS,UAAUC,CAAV,EAAa;AAClB,gBAAIC,OAAO,CAACC,GAAR,CAAYC,QAAZ,KAAyB,YAA7B,EAA2C;AACvCjB,cAAAA,KAAK,CAACjB,MAAN,CAAamC,GAAb,CAAiB,sBAAjB,EAAyCJ,CAAzC;AACH;AACJ,WAVD;AAWH;AACJ;AACJ;AAxCyB,GAAD,EAyC1B;AACCvD,IAAAA,GAAG,EAAE,aADN;AAEChC,IAAAA,KAAK,EAAE,SAASsG,WAAT,CAAqBC,QAArB,EAA+B;AAClC,UAAIC,MAAM,GAAG,IAAb;;AAEA,aAAO7B,OAAO,CAACC,GAAR,CAAYvD,KAAK,CAACoF,IAAN,CAAWF,QAAQ,CAACG,WAApB,EAAiC3B,GAAjC,CAAqC,UAAU4B,KAAV,EAAiB;AACrE,YAAIA,KAAK,CAACC,IAAV,EAAgB;AACZ,iBAAOC,KAAK,CAACF,KAAK,CAACC,IAAP,CAAL,CAAkBzB,IAAlB,CAAuB,UAAU2B,GAAV,EAAe;AACzC,mBAAOA,GAAG,CAACC,IAAJ,EAAP;AACH,WAFM,EAEJ5B,IAFI,CAEC,UAAU4B,IAAV,EAAgB;AACpB,mBAAOC,6BAA6B,CAACD,IAAD,EAAOJ,KAAK,CAACC,IAAb,CAApC;AACH,WAJM,EAIJtB,KAJI,CAIE,UAAUC,CAAV,EAAa;AAClB,gBAAIC,OAAO,CAACC,GAAR,CAAYC,QAAZ,KAAyB,YAA7B,EAA2C;AACvCc,cAAAA,MAAM,CAAChD,MAAP,CAAcmC,GAAd,CAAkB,2BAAlB,EAA+CJ,CAA/C;AACH;;AACD,mBAAO,EAAP;AACH,WATM,CAAP;AAUH;;AACD,eAAO0B,aAAa,CAACN,KAAD,EAAQJ,QAAR,CAApB;AACH,OAdkB,CAAZ,EAcHpB,IAdG,CAcE,UAAU+B,KAAV,EAAiB;AACtB,eAAOA,KAAK,CAACC,MAAN,CAAa,UAAUC,GAAV,EAAeC,IAAf,EAAqB;AACrC,iBAAOD,GAAG,CAACE,MAAJ,CAAWD,IAAX,CAAP;AACH,SAFM,EAEJ,EAFI,CAAP;AAGH,OAlBM,EAkBJlC,IAlBI,CAkBC,UAAU+B,KAAV,EAAiB;AACrB,eAAOvC,OAAO,CAACC,GAAR,CAAYsC,KAAK,CAACnC,GAAN,CAAU,UAAUsC,IAAV,EAAgB;AACzC,iBAAOR,KAAK,CAACQ,IAAI,CAACE,OAAL,CAAa,CAAb,EAAgBlC,GAAjB,CAAL,CAA2BF,IAA3B,CAAgC,UAAUqC,QAAV,EAAoB;AACvD,mBAAOA,QAAQ,CAACC,IAAT,EAAP;AACH,WAFM,EAEJtC,IAFI,CAEC,UAAUsC,IAAV,EAAgB;AACpB,mBAAO,IAAI9C,OAAJ,CAAY,UAAUiB,OAAV,EAAmB8B,MAAnB,EAA2B;AAC1C,kBAAIC,MAAM,GAAG,IAAIC,UAAJ,EAAb;AACAD,cAAAA,MAAM,CAACE,OAAP,GAAiBH,MAAjB;;AACAC,cAAAA,MAAM,CAACG,MAAP,GAAgB,YAAY;AACxB;AACA,oBAAIC,MAAM,GAAGJ,MAAM,CAACI,MAApB;AACAnC,gBAAAA,OAAO,CAACmC,MAAD,CAAP;AACH,eAJD;;AAKAJ,cAAAA,MAAM,CAACK,aAAP,CAAqBP,IAArB;AACH,aATM,CAAP;AAUH,WAbM,EAaJtC,IAbI,CAaC,UAAU8C,OAAV,EAAmB;AACvBZ,YAAAA,IAAI,CAACa,QAAL,CAAcC,WAAd,CAA0B,KAA1B,EAAiC,UAAUF,OAAV,GAAoB,IAArD;AACA,mBAAO,iBAAiBZ,IAAI,CAACa,QAAL,CAAcE,OAA/B,GAAyC,GAAhD;AACH,WAhBM,CAAP;AAiBH,SAlBkB,CAAZ,CAAP;AAmBH,OAtCM,EAsCJjD,IAtCI,CAsCC,UAAUkD,OAAV,EAAmB;AACvB,YAAI3D,KAAK,GAAG6B,QAAQ,CAAC+B,aAAT,CAAuB,OAAvB,CAAZ;AACA5D,QAAAA,KAAK,CAAC6D,WAAN,GAAoBF,OAAO,CAACvC,IAAR,CAAa,IAAb,CAApB;;AACAU,QAAAA,MAAM,CAACpC,eAAP,CAAuBoE,WAAvB,CAAmC9D,KAAnC;AACH,OA1CM,CAAP;AA2CH;AAhDF,GAzC0B,EA0F1B;AACC1C,IAAAA,GAAG,EAAE,oBADN;AAEChC,IAAAA,KAAK,EAAE,SAASyI,kBAAT,CAA4BjE,IAA5B,EAAkC;AACrC,UAAIkE,MAAM,GAAG,IAAb;;AAEA,UAAI,KAAK7E,UAAL,IAAmBW,IAAI,YAAYmE,iBAAvC,EAA0D;AACtD,YAAIvD,GAAG,GAAGZ,IAAI,CAACF,aAAL,CAAmBgE,aAAnB,CAAiC,KAAjC,CAAV;;AACA,YAAI;AACAlD,UAAAA,GAAG,CAACC,GAAJ,GAAUb,IAAI,CAACoE,SAAL,EAAV;AACA,iBAAOxD,GAAP;AACH,SAHD,CAGE,OAAOG,CAAP,EAAU;AACR,cAAIC,OAAO,CAACC,GAAR,CAAYC,QAAZ,KAAyB,YAA7B,EAA2C;AACvC,iBAAKlC,MAAL,CAAYmC,GAAZ,CAAgB,oDAAhB;AACH;AACJ;AACJ;;AAED,UAAInB,IAAI,YAAYqE,iBAApB,EAAuC;AACnC,YAAIC,UAAU,GAAGtE,IAAI,CAACH,SAAL,CAAe,KAAf,CAAjB;AACA,YAAI0E,SAAS,GAAGC,iBAAiB,EAAjC;AACAF,QAAAA,UAAU,CAACG,YAAX,CAAwB,sCAAxB,EAAgEF,SAAhE;;AAEA,YAAIG,YAAY,GAAG,CAAC,GAAG7G,OAAO,CAAC8G,WAAZ,EAAyB3E,IAAzB,EAA+B,CAA/B,EAAkC,CAAlC,CAAnB;AAAA,YACI4E,KAAK,GAAGF,YAAY,CAACE,KADzB;AAAA,YAEIC,MAAM,GAAGH,YAAY,CAACG,MAF1B;;AAIA,aAAKtF,cAAL,CAAoBuF,KAApB,CAA0BP,SAA1B,IAAuCQ,wBAAwB,CAAC/E,IAAD,EAAO,KAAKjB,OAAZ,CAAxB,CAA6C4B,IAA7C,CAAkD,UAAUf,eAAV,EAA2B;AAChH,iBAAOsE,MAAM,CAAChF,QAAP,CAAgBU,eAAhB,EAAiC;AACpCoF,YAAAA,KAAK,EAAEd,MAAM,CAACnF,OAAP,CAAeiG,KADc;AAEpCC,YAAAA,UAAU,EAAEf,MAAM,CAACnF,OAAP,CAAekG,UAFS;AAGpCzD,YAAAA,eAAe,EAAE,SAHmB;AAIpC0D,YAAAA,MAAM,EAAE,IAJ4B;AAKpCC,YAAAA,YAAY,EAAEjB,MAAM,CAACnF,OAAP,CAAeoG,YALO;AAMpCC,YAAAA,OAAO,EAAElB,MAAM,CAACnF,OAAP,CAAeqG,OANY;AAOpCC,YAAAA,KAAK,EAAEnB,MAAM,CAACnF,OAAP,CAAesG,KAPc;AAQpCC,YAAAA,eAAe,EAAEpB,MAAM,CAACnF,OAAP,CAAeuG,eARI;AASpCC,YAAAA,KAAK,EAAErB,MAAM,CAACnF,OAAP,CAAewG,KATc;AAUpCC,YAAAA,sBAAsB,EAAEtB,MAAM,CAACnF,OAAP,CAAeyG,sBAVH;AAWpCC,YAAAA,OAAO,EAAEvB,MAAM,CAACnF,OAAP,CAAe0G,OAXY;AAYpCvI,YAAAA,MAAM,EAAE,IAAIoB,gBAAgB,CAACI,OAArB,EAZ4B;AAapCkG,YAAAA,KAAK,EAAEA,KAb6B;AAcpCC,YAAAA,MAAM,EAAEA,MAd4B;AAepCa,YAAAA,CAAC,EAAE,CAfiC;AAgBpCC,YAAAA,CAAC,EAAE,CAhBiC;AAiBpCC,YAAAA,WAAW,EAAEhG,eAAe,CAACE,aAAhB,CAA8B+F,WAA9B,CAA0CC,UAjBnB;AAkBpCC,YAAAA,YAAY,EAAEnG,eAAe,CAACE,aAAhB,CAA8B+F,WAA9B,CAA0CG,WAlBpB;AAmBpCC,YAAAA,OAAO,EAAErG,eAAe,CAACE,aAAhB,CAA8B+F,WAA9B,CAA0CK,WAnBf;AAoBpCC,YAAAA,OAAO,EAAEvG,eAAe,CAACE,aAAhB,CAA8B+F,WAA9B,CAA0CO;AApBf,WAAjC,EAqBJlC,MAAM,CAAClF,MAAP,CAAcqH,KAAd,CAAoB9B,SAApB,CArBI,CAAP;AAsBH,SAvBsC,EAuBpC5D,IAvBoC,CAuB/B,UAAUuE,MAAV,EAAkB;AACtB,iBAAO,IAAI/E,OAAJ,CAAY,UAAUiB,OAAV,EAAmB8B,MAAnB,EAA2B;AAC1C,gBAAIoD,YAAY,GAAGvE,QAAQ,CAAC+B,aAAT,CAAuB,KAAvB,CAAnB;;AACAwC,YAAAA,YAAY,CAAChD,MAAb,GAAsB,YAAY;AAC9B,qBAAOlC,OAAO,CAAC8D,MAAD,CAAd;AACH,aAFD;;AAGAoB,YAAAA,YAAY,CAACjD,OAAb,GAAuBH,MAAvB;AACAoD,YAAAA,YAAY,CAACzF,GAAb,GAAmBqE,MAAM,CAACd,SAAP,EAAnB;;AACA,gBAAIE,UAAU,CAAC5C,UAAf,EAA2B;AACvB4C,cAAAA,UAAU,CAAC5C,UAAX,CAAsBG,YAAtB,CAAmC,CAAC,GAAG1D,KAAK,CAACyD,aAAV,EAAyB5B,IAAI,CAACF,aAAL,CAAmB+F,WAAnB,CAA+BU,gBAA/B,CAAgDvG,IAAhD,CAAzB,EAAgFsG,YAAhF,CAAnC,EAAkIhC,UAAlI;AACH;AACJ,WAVM,CAAP;AAWH,SAnCsC,CAAvC;AAoCA,eAAOA,UAAP;AACH;;AAED,UAAItE,IAAI,YAAYwG,gBAAhB,IAAoCxG,IAAI,CAACmC,KAAzC,IAAkDnC,IAAI,CAACmC,KAAL,CAAWsE,QAAjE,EAA2E;AACvE,YAAIC,GAAG,GAAG,GAAGC,KAAH,CAASC,IAAT,CAAc5G,IAAI,CAACmC,KAAL,CAAWsE,QAAzB,EAAmC,CAAnC,EAAsC9D,MAAtC,CAA6C,UAAU+D,GAAV,EAAeG,IAAf,EAAqB;AACxE,cAAI;AACA,gBAAIA,IAAI,IAAIA,IAAI,CAACjD,OAAjB,EAA0B;AACtB,qBAAO8C,GAAG,GAAGG,IAAI,CAACjD,OAAlB;AACH;;AACD,mBAAO8C,GAAP;AACH,WALD,CAKE,OAAO9J,GAAP,EAAY;AACVsH,YAAAA,MAAM,CAAClF,MAAP,CAAcmC,GAAd,CAAkB,mCAAlB,EAAuD0F,IAAI,CAACC,IAA5D;;AACA,mBAAOJ,GAAP;AACH;AACJ,SAVS,EAUP,EAVO,CAAV;AAWA,YAAIxG,KAAK,GAAGF,IAAI,CAACH,SAAL,CAAe,KAAf,CAAZ;AACAK,QAAAA,KAAK,CAAC6D,WAAN,GAAoB2C,GAApB;AACA,eAAOxG,KAAP;AACH;;AAED,aAAOF,IAAI,CAACH,SAAL,CAAe,KAAf,CAAP;AACH;AAnFF,GA1F0B,EA8K1B;AACCrC,IAAAA,GAAG,EAAE,WADN;AAEChC,IAAAA,KAAK,EAAE,SAASqE,SAAT,CAAmBG,IAAnB,EAAyB;AAC5B,UAAI+G,KAAK,GAAG/G,IAAI,CAACgH,QAAL,KAAkBC,IAAI,CAACC,SAAvB,GAAmCnF,QAAQ,CAACoF,cAAT,CAAwBnH,IAAI,CAACoH,SAA7B,CAAnC,GAA6E,KAAKnD,kBAAL,CAAwBjE,IAAxB,CAAzF;AAEA,UAAIR,MAAM,GAAGQ,IAAI,CAACF,aAAL,CAAmB+F,WAAhC;AACA,UAAI3F,KAAK,GAAGF,IAAI,YAAYR,MAAM,CAAC6H,WAAvB,GAAqC7H,MAAM,CAAC+G,gBAAP,CAAwBvG,IAAxB,CAArC,GAAqE,IAAjF;AACA,UAAIsH,WAAW,GAAGtH,IAAI,YAAYR,MAAM,CAAC6H,WAAvB,GAAqC7H,MAAM,CAAC+G,gBAAP,CAAwBvG,IAAxB,EAA8B,SAA9B,CAArC,GAAgF,IAAlG;AACA,UAAIuH,UAAU,GAAGvH,IAAI,YAAYR,MAAM,CAAC6H,WAAvB,GAAqC7H,MAAM,CAAC+G,gBAAP,CAAwBvG,IAAxB,EAA8B,QAA9B,CAArC,GAA+E,IAAhG;;AAEA,UAAI,KAAKb,gBAAL,KAA0Ba,IAA1B,IAAkC+G,KAAK,YAAYvH,MAAM,CAAC6H,WAA9D,EAA2E;AACvE,aAAKG,sBAAL,GAA8BT,KAA9B;AACH;;AAED,UAAIA,KAAK,YAAYvH,MAAM,CAACiI,eAA5B,EAA6C;AACzCC,QAAAA,sBAAsB,CAACX,KAAD,CAAtB;AACH;;AAED,UAAIrH,QAAQ,GAAG,CAAC,GAAGnB,kBAAkB,CAACoJ,iBAAvB,EAA0CzH,KAA1C,EAAiD,KAAKT,iBAAtD,CAAf;AACA,UAAImI,aAAa,GAAG,CAAC,GAAGrJ,kBAAkB,CAACsJ,oBAAvB,EAA6C7H,IAA7C,EAAmDsH,WAAnD,EAAgE,KAAK7H,iBAArE,CAApB;;AAEA,WAAK,IAAI4G,KAAK,GAAGrG,IAAI,CAAC8H,UAAtB,EAAkCzB,KAAlC,EAAyCA,KAAK,GAAGA,KAAK,CAAC0B,WAAvD,EAAoE;AAChE,YAAI1B,KAAK,CAACW,QAAN,KAAmBC,IAAI,CAACe,YAAxB,IAAwC3B,KAAK,CAAC4B,QAAN,KAAmB,QAAnB,IAC5C;AACA,SAAC5B,KAAK,CAAC6B,YAAN,CAAmBrJ,gBAAnB,CAF2C,KAEF,OAAO,KAAKE,OAAL,CAAaoJ,cAApB,KAAuC,UAAvC,IAC1C;AACA,SAAC,KAAKpJ,OAAL,CAAaoJ,cAAb,CAA4B9B,KAA5B,CAJ2C,CAA5C,EAIsC;AAClC,cAAI,CAAC,KAAKhH,UAAN,IAAoBgH,KAAK,CAAC4B,QAAN,KAAmB,OAA3C,EAAoD;AAChDlB,YAAAA,KAAK,CAAC/C,WAAN,CAAkB,KAAKnE,SAAL,CAAewG,KAAf,CAAlB;AACH;AACJ;AACJ;;AAED,UAAI+B,YAAY,GAAG,CAAC,GAAG7J,kBAAkB,CAACsJ,oBAAvB,EAA6C7H,IAA7C,EAAmDuH,UAAnD,EAA+D,KAAK9H,iBAApE,CAAnB;AACA,OAAC,GAAGlB,kBAAkB,CAAC8J,WAAvB,EAAoC3I,QAApC,EAA8C,KAAKD,iBAAnD;;AAEA,UAAIO,IAAI,YAAYR,MAAM,CAAC6H,WAAvB,IAAsCN,KAAK,YAAYvH,MAAM,CAAC6H,WAAlE,EAA+E;AAC3E,YAAIC,WAAJ,EAAiB;AACb,eAAKvH,eAAL,CAAqBuI,mBAAmB,CAACtI,IAAD,EAAO+G,KAAP,EAAcO,WAAd,EAA2BM,aAA3B,EAA0CW,aAA1C,CAAxC;AACH;;AACD,YAAIhB,UAAJ,EAAgB;AACZ,eAAKxH,eAAL,CAAqBuI,mBAAmB,CAACtI,IAAD,EAAO+G,KAAP,EAAcQ,UAAd,EAA0Ba,YAA1B,EAAwCI,YAAxC,CAAxC;AACH;;AACD,YAAItI,KAAK,IAAI,KAAKb,UAAd,IAA4B,EAAEW,IAAI,YAAYqE,iBAAlB,CAAhC,EAAsE;AAClE,WAAC,GAAGlG,KAAK,CAACyD,aAAV,EAAyB1B,KAAzB,EAAgC6G,KAAhC;AACH;;AACD,aAAKhH,eAAL,CAAqBgH,KAArB;;AACA,YAAI/G,IAAI,CAACyI,SAAL,KAAmB,CAAnB,IAAwBzI,IAAI,CAAC0I,UAAL,KAAoB,CAAhD,EAAmD;AAC/C,eAAKtJ,gBAAL,CAAsB1C,IAAtB,CAA2B,CAACqK,KAAD,EAAQ/G,IAAI,CAAC0I,UAAb,EAAyB1I,IAAI,CAACyI,SAA9B,CAA3B;AACH;;AACD,gBAAQzI,IAAI,CAACiI,QAAb;AACI,eAAK,QAAL;AACI,gBAAI,CAAC,KAAK5I,UAAV,EAAsB;AAClBsJ,cAAAA,mBAAmB,CAAC3I,IAAD,EAAO+G,KAAP,CAAnB;AACH;;AACD;;AACJ,eAAK,UAAL;AACA,eAAK,QAAL;AACIA,YAAAA,KAAK,CAACvL,KAAN,GAAcwE,IAAI,CAACxE,KAAnB;AACA;AATR;AAWH;;AACD,aAAOuL,KAAP;AACH;AA/DF,GA9K0B,CAAjB,CAAZ;;AAgPA,SAAOrL,cAAP;AACH,CArQ6C,EAA9C;;AAuQA,IAAI+G,aAAa,GAAG,SAASA,aAAT,CAAuBN,KAAvB,EAA8BJ,QAA9B,EAAwC;AACxD;AACA,SAAO,CAACI,KAAK,CAACsE,QAAN,GAAiB5J,KAAK,CAACoF,IAAN,CAAWE,KAAK,CAACsE,QAAjB,CAAjB,GAA8C,EAA/C,EAAmDmC,MAAnD,CAA0D,UAAU/B,IAAV,EAAgB;AAC7E,WAAOA,IAAI,CAACgC,IAAL,KAAcC,OAAO,CAACC,cAA7B;AACH,GAFM,EAEJxI,GAFI,CAEA,UAAUsG,IAAV,EAAgB;AACnB,QAAIhG,GAAG,GAAG,CAAC,GAAGzC,WAAW,CAACiC,oBAAhB,EAAsCwG,IAAI,CAAC3G,KAAL,CAAW8I,gBAAX,CAA4B,KAA5B,CAAtC,CAAV;AACA,QAAIjG,OAAO,GAAG,EAAd;;AACA,SAAK,IAAIhH,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG8E,GAAG,CAAClE,MAAxB,EAAgCZ,CAAC,EAAjC,EAAqC;AACjC,UAAI8E,GAAG,CAAC9E,CAAD,CAAH,CAAOyE,MAAP,KAAkB,KAAlB,IAA2BK,GAAG,CAAC9E,CAAC,GAAG,CAAL,CAA9B,IAAyC8E,GAAG,CAAC9E,CAAC,GAAG,CAAL,CAAH,CAAWyE,MAAX,KAAsB,QAAnE,EAA6E;AACzE,YAAIyI,CAAC,GAAGlH,QAAQ,CAAC+B,aAAT,CAAuB,GAAvB,CAAR;AACAmF,QAAAA,CAAC,CAAC7G,IAAF,GAASvB,GAAG,CAAC9E,CAAD,CAAH,CAAO2E,IAAP,CAAY,CAAZ,CAAT;;AACA,YAAIqB,QAAQ,CAACmH,IAAb,EAAmB;AACfnH,UAAAA,QAAQ,CAACmH,IAAT,CAAclF,WAAd,CAA0BiF,CAA1B;AACH;;AAED,YAAIpG,IAAI,GAAG;AACPhC,UAAAA,GAAG,EAAEoI,CAAC,CAAC7G,IADA;AAEP+G,UAAAA,MAAM,EAAEtI,GAAG,CAAC9E,CAAC,GAAG,CAAL,CAAH,CAAW2E,IAAX,CAAgB,CAAhB;AAFD,SAAX;AAIAqC,QAAAA,OAAO,CAACrG,IAAR,CAAamG,IAAb;AACH;AACJ;;AAED,WAAO;AACH;AAEAE,MAAAA,OAAO,EAAEA,OAAO,CAAC6F,MAAR,CAAe,UAAU/F,IAAV,EAAgB;AACpC,eAAQ,SAASuG,IAAT,CAAcvG,IAAI,CAACsG,MAAnB,CAAR;AAEH,OAHQ,CAHN;AAOHzF,MAAAA,QAAQ,EAAEmD,IAAI,CAAC3G;AAPZ,KAAP;AASH,GA9BM,EA8BJ0I,MA9BI,CA8BG,UAAU/F,IAAV,EAAgB;AACtB,WAAOA,IAAI,CAACE,OAAL,CAAapG,MAApB;AACH,GAhCM,CAAP;AAiCH,CAnCD;;AAqCA,IAAI6F,6BAA6B,GAAG,SAASA,6BAAT,CAAuCD,IAAvC,EAA6C8G,QAA7C,EAAuD;AACvF,MAAIC,GAAG,GAAGvH,QAAQ,CAACwH,cAAT,CAAwBC,kBAAxB,CAA2C,EAA3C,CAAV;AACA,MAAIC,IAAI,GAAG1H,QAAQ,CAAC+B,aAAT,CAAuB,MAAvB,CAAX,CAFuF,CAGvF;;AACA2F,EAAAA,IAAI,CAACrH,IAAL,GAAYiH,QAAZ;AACA,MAAInJ,KAAK,GAAG6B,QAAQ,CAAC+B,aAAT,CAAuB,OAAvB,CAAZ;AAEA5D,EAAAA,KAAK,CAAC6D,WAAN,GAAoBxB,IAApB;;AACA,MAAI+G,GAAG,CAACI,IAAR,EAAc;AACVJ,IAAAA,GAAG,CAACI,IAAJ,CAAS1F,WAAT,CAAqByF,IAArB;AACH;;AACD,MAAIH,GAAG,CAACJ,IAAR,EAAc;AACVI,IAAAA,GAAG,CAACJ,IAAJ,CAASlF,WAAT,CAAqB9D,KAArB;AACH;;AAED,SAAOA,KAAK,CAACiC,KAAN,GAAcM,aAAa,CAACvC,KAAK,CAACiC,KAAP,EAAcmH,GAAd,CAA3B,GAAgD,EAAvD;AACH,CAhBD;;AAkBA,IAAIK,kBAAkB,GAAG,SAASA,kBAAT,CAA4B7J,aAA5B,EAA2C4F,CAA3C,EAA8CC,CAA9C,EAAiD;AACtE,MAAI7F,aAAa,CAAC+F,WAAd,KAA8BH,CAAC,KAAK5F,aAAa,CAAC+F,WAAd,CAA0BK,WAAhC,IAA+CP,CAAC,KAAK7F,aAAa,CAAC+F,WAAd,CAA0BO,WAA7G,CAAJ,EAA+H;AAC3HtG,IAAAA,aAAa,CAAC+F,WAAd,CAA0B+D,QAA1B,CAAmClE,CAAnC,EAAsCC,CAAtC;AACH;AACJ,CAJD;;AAMA,IAAIgD,mBAAmB,GAAG,SAASA,mBAAT,CAA6BzD,MAA7B,EAAqC2E,YAArC,EAAmD;AACzE,MAAI;AACA,QAAIA,YAAJ,EAAkB;AACdA,MAAAA,YAAY,CAACjF,KAAb,GAAqBM,MAAM,CAACN,KAA5B;AACAiF,MAAAA,YAAY,CAAChF,MAAb,GAAsBK,MAAM,CAACL,MAA7B;AACA,UAAIiF,GAAG,GAAG5E,MAAM,CAAC6E,UAAP,CAAkB,IAAlB,CAAV;AACA,UAAIC,SAAS,GAAGH,YAAY,CAACE,UAAb,CAAwB,IAAxB,CAAhB;;AACA,UAAID,GAAJ,EAAS;AACLE,QAAAA,SAAS,CAACC,YAAV,CAAuBH,GAAG,CAACI,YAAJ,CAAiB,CAAjB,EAAoB,CAApB,EAAuBhF,MAAM,CAACN,KAA9B,EAAqCM,MAAM,CAACL,MAA5C,CAAvB,EAA4E,CAA5E,EAA+E,CAA/E;AACH,OAFD,MAEO;AACHmF,QAAAA,SAAS,CAACG,SAAV,CAAoBjF,MAApB,EAA4B,CAA5B,EAA+B,CAA/B;AACH;AACJ;AACJ,GAZD,CAYE,OAAOnE,CAAP,EAAU,CAAE;AACjB,CAdD;;AAgBA,IAAIuH,mBAAmB,GAAG,SAASA,mBAAT,CAA6BtI,IAA7B,EAAmC+G,KAAnC,EAA0C7G,KAA1C,EAAiDkK,YAAjD,EAA+DC,SAA/D,EAA0E;AAChG,MAAI,CAACnK,KAAD,IAAU,CAACA,KAAK,CAACoK,OAAjB,IAA4BpK,KAAK,CAACoK,OAAN,KAAkB,MAA9C,IAAwDpK,KAAK,CAACoK,OAAN,KAAkB,kBAA1E,IAAgGpK,KAAK,CAACqK,OAAN,KAAkB,MAAtH,EAA8H;AAC1H;AACH;;AAED,MAAIC,wBAAwB,GAAGzD,KAAK,CAACjH,aAAN,CAAoBgE,aAApB,CAAkC,0BAAlC,CAA/B;AACA,GAAC,GAAG3F,KAAK,CAACyD,aAAV,EAAyB1B,KAAzB,EAAgCsK,wBAAhC;;AAEA,MAAIJ,YAAJ,EAAkB;AACd,QAAIK,GAAG,GAAGL,YAAY,CAACzN,MAAvB;;AACA,SAAK,IAAIZ,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG0O,GAApB,EAAyB1O,CAAC,EAA1B,EAA8B;AAC1B,UAAI2O,IAAI,GAAGN,YAAY,CAACrO,CAAD,CAAvB;;AACA,cAAQ2O,IAAI,CAAC7B,IAAb;AACI,aAAKtK,kBAAkB,CAACoM,wBAAnB,CAA4CC,KAAjD;AACI,cAAIhK,GAAG,GAAGmG,KAAK,CAACjH,aAAN,CAAoBgE,aAApB,CAAkC,KAAlC,CAAV;AACAlD,UAAAA,GAAG,CAACC,GAAJ,GAAU,CAAC,GAAGzC,WAAW,CAACiC,oBAAhB,EAAsC,SAASqK,IAAI,CAAClP,KAAd,GAAsB,GAA5D,EAAiE,CAAjE,EAAoEkF,IAApE,CAAyE,CAAzE,CAAV;AACAE,UAAAA,GAAG,CAACV,KAAJ,CAAU2K,OAAV,GAAoB,GAApB;AACAL,UAAAA,wBAAwB,CAACxG,WAAzB,CAAqCpD,GAArC;AACA;;AACJ,aAAKrC,kBAAkB,CAACoM,wBAAnB,CAA4CG,IAAjD;AACIN,UAAAA,wBAAwB,CAACxG,WAAzB,CAAqC+C,KAAK,CAACjH,aAAN,CAAoBqH,cAApB,CAAmCuD,IAAI,CAAClP,KAAxC,CAArC;AACA;AATR;AAWH;AACJ;;AAEDgP,EAAAA,wBAAwB,CAACO,SAAzB,GAAqCC,gCAAgC,GAAG,GAAnC,GAAyCC,+BAA9E;AACAlE,EAAAA,KAAK,CAACgE,SAAN,IAAmBV,SAAS,KAAK9B,aAAd,GAA8B,MAAMyC,gCAApC,GAAuE,MAAMC,+BAAhG;;AACA,MAAIZ,SAAS,KAAK9B,aAAlB,EAAiC;AAC7BxB,IAAAA,KAAK,CAACmE,YAAN,CAAmBV,wBAAnB,EAA6CzD,KAAK,CAACe,UAAnD;AACH,GAFD,MAEO;AACHf,IAAAA,KAAK,CAAC/C,WAAN,CAAkBwG,wBAAlB;AACH;;AAED,SAAOA,wBAAP;AACH,CAnCD;;AAqCA,IAAIW,UAAU,GAAG,gBAAjB;AACA,IAAI5C,aAAa,GAAG,SAApB;AACA,IAAIC,YAAY,GAAG,QAAnB;AACA,IAAIwC,gCAAgC,GAAG,uCAAvC;AACA,IAAIC,+BAA+B,GAAG,sCAAtC;AAEA,IAAIG,yBAAyB,GAAG,kEAAhC;;AAEA,IAAI1D,sBAAsB,GAAG,SAASA,sBAAT,CAAgCwB,IAAhC,EAAsC;AAC/DmC,EAAAA,YAAY,CAACnC,IAAD,EAAO,MAAM8B,gCAAN,GAAyCzC,aAAzC,GAAyD6C,yBAAzD,GAAqF,cAArF,GAAsGH,+BAAtG,GAAwIzC,YAAxI,GAAuJ4C,yBAA9J,CAAZ;AACH,CAFD;;AAIA,IAAIC,YAAY,GAAG,SAASA,YAAT,CAAsBnC,IAAtB,EAA4BoC,MAA5B,EAAoC;AACnD,MAAIpL,KAAK,GAAGgJ,IAAI,CAACpJ,aAAL,CAAmBgE,aAAnB,CAAiC,OAAjC,CAAZ;AACA5D,EAAAA,KAAK,CAACqL,SAAN,GAAkBD,MAAlB;AACApC,EAAAA,IAAI,CAAClF,WAAL,CAAiB9D,KAAjB;AACH,CAJD;;AAMA,IAAIsL,QAAQ,GAAG,SAASA,QAAT,CAAkBC,IAAlB,EAAwB;AACnC,MAAIC,KAAK,GAAG9P,cAAc,CAAC6P,IAAD,EAAO,CAAP,CAA1B;AAAA,MACI3M,OAAO,GAAG4M,KAAK,CAAC,CAAD,CADnB;AAAA,MAEIhG,CAAC,GAAGgG,KAAK,CAAC,CAAD,CAFb;AAAA,MAGI/F,CAAC,GAAG+F,KAAK,CAAC,CAAD,CAHb;;AAKA5M,EAAAA,OAAO,CAAC4J,UAAR,GAAqBhD,CAArB;AACA5G,EAAAA,OAAO,CAAC2J,SAAR,GAAoB9C,CAApB;AACH,CARD;;AAUA,IAAInB,iBAAiB,GAAG,SAASA,iBAAT,GAA6B;AACjD,SAAOmH,IAAI,CAACC,IAAL,CAAUC,IAAI,CAACC,GAAL,KAAaH,IAAI,CAACI,MAAL,KAAgB,QAAvC,EAAiDC,QAAjD,CAA0D,EAA1D,CAAP;AACH,CAFD;;AAIA,IAAIC,eAAe,GAAG,mCAAtB;;AAEA,IAAIlH,wBAAwB,GAAG,SAASA,wBAAT,CAAkC/E,IAAlC,EAAwCjB,OAAxC,EAAiD;AAC5E,MAAI;AACA,WAAOoB,OAAO,CAACiB,OAAR,CAAgBpB,IAAI,CAACkM,aAAL,CAAmBnK,QAAnB,CAA4BnC,eAA5C,CAAP;AACH,GAFD,CAEE,OAAOmB,CAAP,EAAU;AACR,WAAOhC,OAAO,CAACsG,KAAR,GAAgB,CAAC,GAAGtH,MAAM,CAACoO,KAAX,EAAkBnM,IAAI,CAACa,GAAvB,EAA4B9B,OAA5B,EAAqC4B,IAArC,CAA0C,UAAUyL,IAAV,EAAgB;AAC7E,UAAIC,KAAK,GAAGD,IAAI,CAACC,KAAL,CAAWJ,eAAX,CAAZ;;AACA,UAAI,CAACI,KAAL,EAAY;AACR,eAAOlM,OAAO,CAAC+C,MAAR,EAAP;AACH;;AAED,aAAOmJ,KAAK,CAAC,CAAD,CAAL,KAAa,QAAb,GAAwB7M,MAAM,CAAC8M,IAAP,CAAYC,kBAAkB,CAACF,KAAK,CAAC,CAAD,CAAN,CAA9B,CAAxB,GAAoEE,kBAAkB,CAACF,KAAK,CAAC,CAAD,CAAN,CAA7F;AACH,KAPsB,EAOpB1L,IAPoB,CAOf,UAAUyL,IAAV,EAAgB;AACpB,aAAOI,qBAAqB,CAACxM,IAAI,CAACF,aAAN,EAAqB,CAAC,GAAGjC,OAAO,CAAC8G,WAAZ,EAAyB3E,IAAzB,EAA+B,CAA/B,EAAkC,CAAlC,CAArB,CAArB,CAAgFW,IAAhF,CAAqF,UAAU8L,oBAAV,EAAgC;AACxH,YAAIhR,WAAW,GAAGgR,oBAAoB,CAACP,aAAvC;AACA,YAAIQ,aAAa,GAAGjR,WAAW,CAACsG,QAAhC;AAEA2K,QAAAA,aAAa,CAACC,IAAd;AACAD,QAAAA,aAAa,CAACE,KAAd,CAAoBR,IAApB;AACA,YAAIS,UAAU,GAAGC,YAAY,CAACL,oBAAD,CAAZ,CAAmC9L,IAAnC,CAAwC,YAAY;AACjE,iBAAO+L,aAAa,CAAC9M,eAArB;AACH,SAFgB,CAAjB;AAIA8M,QAAAA,aAAa,CAACK,KAAd;AACA,eAAOF,UAAP;AACH,OAZM,CAAP;AAaH,KArBsB,CAAhB,GAqBF1M,OAAO,CAAC+C,MAAR,EArBL;AAsBH;AACJ,CA3BD;;AA6BA,IAAIsJ,qBAAqB,GAAG,SAASA,qBAAT,CAA+B1M,aAA/B,EAA8CkN,MAA9C,EAAsD;AAC9E,MAAIP,oBAAoB,GAAG3M,aAAa,CAACgE,aAAd,CAA4B,QAA5B,CAA3B;AAEA2I,EAAAA,oBAAoB,CAAC1B,SAArB,GAAiC,uBAAjC;AACA0B,EAAAA,oBAAoB,CAACvM,KAArB,CAA2B+M,UAA3B,GAAwC,QAAxC;AACAR,EAAAA,oBAAoB,CAACvM,KAArB,CAA2BgN,QAA3B,GAAsC,OAAtC;AACAT,EAAAA,oBAAoB,CAACvM,KAArB,CAA2BiN,IAA3B,GAAkC,UAAlC;AACAV,EAAAA,oBAAoB,CAACvM,KAArB,CAA2BkN,GAA3B,GAAiC,KAAjC;AACAX,EAAAA,oBAAoB,CAACvM,KAArB,CAA2BmN,MAA3B,GAAoC,GAApC;AACAZ,EAAAA,oBAAoB,CAAC7H,KAArB,GAA6BoI,MAAM,CAACpI,KAAP,CAAaoH,QAAb,EAA7B;AACAS,EAAAA,oBAAoB,CAAC5H,MAArB,GAA8BmI,MAAM,CAACnI,MAAP,CAAcmH,QAAd,EAA9B;AACAS,EAAAA,oBAAoB,CAACa,SAArB,GAAiC,IAAjC,CAX8E,CAWvC;;AACvCb,EAAAA,oBAAoB,CAAChI,YAArB,CAAkC5F,gBAAlC,EAAoD,MAApD;;AACA,MAAI,CAACiB,aAAa,CAACoJ,IAAnB,EAAyB;AACrB,WAAO/I,OAAO,CAAC+C,MAAR,CAAelC,OAAO,CAACC,GAAR,CAAYC,QAAZ,KAAyB,YAAzB,GAAwC,6DAAxC,GAAwG,EAAvH,CAAP;AACH;;AAEDpB,EAAAA,aAAa,CAACoJ,IAAd,CAAmBlF,WAAnB,CAA+ByI,oBAA/B;AAEA,SAAOtM,OAAO,CAACiB,OAAR,CAAgBqL,oBAAhB,CAAP;AACH,CApBD;;AAsBA,IAAIK,YAAY,GAAG,SAASA,YAAT,CAAsBL,oBAAtB,EAA4C;AAC3D,MAAIhR,WAAW,GAAGgR,oBAAoB,CAACP,aAAvC;AACA,MAAIQ,aAAa,GAAGjR,WAAW,CAACsG,QAAhC;AAEA,SAAO,IAAI5B,OAAJ,CAAY,UAAUiB,OAAV,EAAmB8B,MAAnB,EAA2B;AAC1CzH,IAAAA,WAAW,CAAC6H,MAAZ,GAAqBmJ,oBAAoB,CAACnJ,MAArB,GAA8BoJ,aAAa,CAACa,kBAAd,GAAmC,YAAY;AAC9F,UAAIC,QAAQ,GAAGC,WAAW,CAAC,YAAY;AACnC,YAAIf,aAAa,CAACxD,IAAd,CAAmBwE,UAAnB,CAA8B/Q,MAA9B,GAAuC,CAAvC,IAA4C+P,aAAa,CAACiB,UAAd,KAA6B,UAA7E,EAAyF;AACrFC,UAAAA,aAAa,CAACJ,QAAD,CAAb;AACApM,UAAAA,OAAO,CAACqL,oBAAD,CAAP;AACH;AACJ,OALyB,EAKvB,EALuB,CAA1B;AAMH,KAPD;AAQH,GATM,CAAP;AAUH,CAdD;;AAgBA,IAAIhR,WAAW,GAAGF,OAAO,CAACE,WAAR,GAAsB,SAASA,WAAT,CAAqBqE,aAArB,EAAoCkN,MAApC,EAA4C7N,gBAA5C,EAA8DJ,OAA9D,EAAuEC,MAAvE,EAA+EE,QAA/E,EAAyF;AAC7H,MAAI2O,MAAM,GAAG,IAAInS,cAAJ,CAAmByD,gBAAnB,EAAqCJ,OAArC,EAA8CC,MAA9C,EAAsD,KAAtD,EAA6DE,QAA7D,CAAb;AACA,MAAI+G,OAAO,GAAGnG,aAAa,CAAC+F,WAAd,CAA0BK,WAAxC;AACA,MAAIC,OAAO,GAAGrG,aAAa,CAAC+F,WAAd,CAA0BO,WAAxC;AAEA,SAAOoG,qBAAqB,CAAC1M,aAAD,EAAgBkN,MAAhB,CAArB,CAA6CrM,IAA7C,CAAkD,UAAU8L,oBAAV,EAAgC;AACrF,QAAIhR,WAAW,GAAGgR,oBAAoB,CAACP,aAAvC;AACA,QAAIQ,aAAa,GAAGjR,WAAW,CAACsG,QAAhC;AAEA;AACR;AACA;;AAEQ,QAAI8K,UAAU,GAAGC,YAAY,CAACL,oBAAD,CAAZ,CAAmC9L,IAAnC,CAAwC,YAAY;AACjEkN,MAAAA,MAAM,CAACzO,gBAAP,CAAwB0O,OAAxB,CAAgCtC,QAAhC;AACA/P,MAAAA,WAAW,CAACmO,QAAZ,CAAqBoD,MAAM,CAACG,IAA5B,EAAkCH,MAAM,CAACI,GAAzC;;AACA,UAAI,sBAAsBhE,IAAtB,CAA2B2E,SAAS,CAACC,SAArC,MAAoDvS,WAAW,CAAC0K,OAAZ,KAAwB6G,MAAM,CAACI,GAA/B,IAAsC3R,WAAW,CAACwK,OAAZ,KAAwB+G,MAAM,CAACG,IAAzH,CAAJ,EAAoI;AAChIT,QAAAA,aAAa,CAAC9M,eAAd,CAA8BM,KAA9B,CAAoCkN,GAApC,GAA0C,CAACJ,MAAM,CAACI,GAAR,GAAc,IAAxD;AACAV,QAAAA,aAAa,CAAC9M,eAAd,CAA8BM,KAA9B,CAAoCiN,IAApC,GAA2C,CAACH,MAAM,CAACG,IAAR,GAAe,IAA1D;AACAT,QAAAA,aAAa,CAAC9M,eAAd,CAA8BM,KAA9B,CAAoCgN,QAApC,GAA+C,UAA/C;AACH;;AAED,UAAI3J,MAAM,GAAGpD,OAAO,CAACiB,OAAR,CAAgB,CAACqL,oBAAD,EAAuBoB,MAAM,CAACrG,sBAA9B,EAAsDqG,MAAM,CAACtO,cAA7D,CAAhB,CAAb;AAEA,UAAI0O,OAAO,GAAGlP,OAAO,CAACkP,OAAtB;AAEA,aAAOJ,MAAM,CAACrG,sBAAP,YAAyC/L,WAAW,CAAC4L,WAArD,IAAoEwG,MAAM,CAACrG,sBAAP,YAAyC1H,aAAa,CAAC+F,WAAd,CAA0BwB,WAAvI,IAAsJwG,MAAM,CAACrG,sBAAP,YAAyCH,WAA/L,GAA6M,OAAO4G,OAAP,KAAmB,UAAnB,GAAgC9N,OAAO,CAACiB,OAAR,GAAkBT,IAAlB,CAAuB,YAAY;AACnR,eAAOsN,OAAO,CAACvB,aAAD,CAAd;AACH,OAFmP,EAEjP/L,IAFiP,CAE5O,YAAY;AAChB,eAAO4C,MAAP;AACH,OAJmP,CAAhC,GAI/MA,MAJE,GAIOpD,OAAO,CAAC+C,MAAR,CAAelC,OAAO,CAACC,GAAR,CAAYC,QAAZ,KAAyB,YAAzB,GAAwC,uBAAuB/B,gBAAgB,CAAC8I,QAAxC,GAAmD,yBAA3F,GAAuH,EAAtI,CAJd;AAKH,KAlBgB,CAAjB;AAoBAyE,IAAAA,aAAa,CAACC,IAAd;AACAD,IAAAA,aAAa,CAACE,KAAd,CAAoBsB,gBAAgB,CAACnM,QAAQ,CAACoM,OAAV,CAAhB,GAAqC,eAAzD,EA7BqF,CA8BrF;;AACAxE,IAAAA,kBAAkB,CAACxK,gBAAgB,CAACW,aAAlB,EAAiCmG,OAAjC,EAA0CE,OAA1C,CAAlB;AACAuG,IAAAA,aAAa,CAAC7K,YAAd,CAA2B6K,aAAa,CAAC0B,SAAd,CAAwBP,MAAM,CAACjO,eAA/B,CAA3B,EAA4E8M,aAAa,CAAC9M,eAA1F;AACA8M,IAAAA,aAAa,CAACK,KAAd;AAEA,WAAOF,UAAP;AACH,GApCM,CAAP;AAqCH,CA1CD;;AA4CA,IAAIqB,gBAAgB,GAAG,SAASA,gBAAT,CAA0BC,OAA1B,EAAmC;AACtD,MAAIE,GAAG,GAAG,EAAV;;AACA,MAAIF,OAAJ,EAAa;AACTE,IAAAA,GAAG,IAAI,YAAP;;AACA,QAAIF,OAAO,CAACrH,IAAZ,EAAkB;AACduH,MAAAA,GAAG,IAAIF,OAAO,CAACrH,IAAf;AACH;;AAED,QAAIqH,OAAO,CAACG,cAAZ,EAA4B;AACxBD,MAAAA,GAAG,IAAIF,OAAO,CAACG,cAAf;AACH;;AAED,QAAIH,OAAO,CAACI,QAAZ,EAAsB;AAClBF,MAAAA,GAAG,IAAI,MAAMF,OAAO,CAACI,QAAd,GAAyB,GAAhC;AACH;;AAED,QAAIJ,OAAO,CAACK,QAAZ,EAAsB;AAClBH,MAAAA,GAAG,IAAI,MAAMF,OAAO,CAACK,QAAd,GAAyB,GAAhC;AACH;;AAEDH,IAAAA,GAAG,IAAI,GAAP;AACH;;AAED,SAAOA,GAAP;AACH,CAxBD","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.cloneWindow = exports.DocumentCloner = undefined;\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _Bounds = require('./Bounds');\n\nvar _Proxy = require('./Proxy');\n\nvar _ResourceLoader = require('./ResourceLoader');\n\nvar _ResourceLoader2 = _interopRequireDefault(_ResourceLoader);\n\nvar _Util = require('./Util');\n\nvar _background = require('./parsing/background');\n\nvar _CanvasRenderer = require('./renderer/CanvasRenderer');\n\nvar _CanvasRenderer2 = _interopRequireDefault(_CanvasRenderer);\n\nvar _PseudoNodeContent = require('./PseudoNodeContent');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar IGNORE_ATTRIBUTE = 'data-html2canvas-ignore';\n\nvar DocumentCloner = exports.DocumentCloner = function () {\n    function DocumentCloner(element, options, logger, copyInline, renderer) {\n        _classCallCheck(this, DocumentCloner);\n\n        this.referenceElement = element;\n        this.scrolledElements = [];\n        this.copyStyles = copyInline;\n        this.inlineImages = copyInline;\n        this.logger = logger;\n        this.options = options;\n        this.renderer = renderer;\n        this.resourceLoader = new _ResourceLoader2.default(options, logger, window);\n        this.pseudoContentData = {\n            counters: {},\n            quoteDepth: 0\n        };\n        // $FlowFixMe\n        this.documentElement = this.cloneNode(element.ownerDocument.documentElement);\n    }\n\n    _createClass(DocumentCloner, [{\n        key: 'inlineAllImages',\n        value: function inlineAllImages(node) {\n            var _this = this;\n\n            if (this.inlineImages && node) {\n                var style = node.style;\n                Promise.all((0, _background.parseBackgroundImage)(style.backgroundImage).map(function (backgroundImage) {\n                    if (backgroundImage.method === 'url') {\n                        return _this.resourceLoader.inlineImage(backgroundImage.args[0]).then(function (img) {\n                            return img && typeof img.src === 'string' ? 'url(\"' + img.src + '\")' : 'none';\n                        }).catch(function (e) {\n                            if (process.env.NODE_ENV !== 'production') {\n                                _this.logger.log('Unable to load image', e);\n                            }\n                        });\n                    }\n                    return Promise.resolve('' + backgroundImage.prefix + backgroundImage.method + '(' + backgroundImage.args.join(',') + ')');\n                })).then(function (backgroundImages) {\n                    if (backgroundImages.length > 1) {\n                        // TODO Multiple backgrounds somehow broken in Chrome\n                        style.backgroundColor = '';\n                    }\n                    style.backgroundImage = backgroundImages.join(',');\n                });\n\n                if (node instanceof HTMLImageElement) {\n                    this.resourceLoader.inlineImage(node.src).then(function (img) {\n                        if (img && node instanceof HTMLImageElement && node.parentNode) {\n                            var parentNode = node.parentNode;\n                            var clonedChild = (0, _Util.copyCSSStyles)(node.style, img.cloneNode(false));\n                            parentNode.replaceChild(clonedChild, node);\n                        }\n                    }).catch(function (e) {\n                        if (process.env.NODE_ENV !== 'production') {\n                            _this.logger.log('Unable to load image', e);\n                        }\n                    });\n                }\n            }\n        }\n    }, {\n        key: 'inlineFonts',\n        value: function inlineFonts(document) {\n            var _this2 = this;\n\n            return Promise.all(Array.from(document.styleSheets).map(function (sheet) {\n                if (sheet.href) {\n                    return fetch(sheet.href).then(function (res) {\n                        return res.text();\n                    }).then(function (text) {\n                        return createStyleSheetFontsFromText(text, sheet.href);\n                    }).catch(function (e) {\n                        if (process.env.NODE_ENV !== 'production') {\n                            _this2.logger.log('Unable to load stylesheet', e);\n                        }\n                        return [];\n                    });\n                }\n                return getSheetFonts(sheet, document);\n            })).then(function (fonts) {\n                return fonts.reduce(function (acc, font) {\n                    return acc.concat(font);\n                }, []);\n            }).then(function (fonts) {\n                return Promise.all(fonts.map(function (font) {\n                    return fetch(font.formats[0].src).then(function (response) {\n                        return response.blob();\n                    }).then(function (blob) {\n                        return new Promise(function (resolve, reject) {\n                            var reader = new FileReader();\n                            reader.onerror = reject;\n                            reader.onload = function () {\n                                // $FlowFixMe\n                                var result = reader.result;\n                                resolve(result);\n                            };\n                            reader.readAsDataURL(blob);\n                        });\n                    }).then(function (dataUri) {\n                        font.fontFace.setProperty('src', 'url(\"' + dataUri + '\")');\n                        return '@font-face {' + font.fontFace.cssText + ' ';\n                    });\n                }));\n            }).then(function (fontCss) {\n                var style = document.createElement('style');\n                style.textContent = fontCss.join('\\n');\n                _this2.documentElement.appendChild(style);\n            });\n        }\n    }, {\n        key: 'createElementClone',\n        value: function createElementClone(node) {\n            var _this3 = this;\n\n            if (this.copyStyles && node instanceof HTMLCanvasElement) {\n                var img = node.ownerDocument.createElement('img');\n                try {\n                    img.src = node.toDataURL();\n                    return img;\n                } catch (e) {\n                    if (process.env.NODE_ENV !== 'production') {\n                        this.logger.log('Unable to clone canvas contents, canvas is tainted');\n                    }\n                }\n            }\n\n            if (node instanceof HTMLIFrameElement) {\n                var tempIframe = node.cloneNode(false);\n                var iframeKey = generateIframeKey();\n                tempIframe.setAttribute('data-html2canvas-internal-iframe-key', iframeKey);\n\n                var _parseBounds = (0, _Bounds.parseBounds)(node, 0, 0),\n                    width = _parseBounds.width,\n                    height = _parseBounds.height;\n\n                this.resourceLoader.cache[iframeKey] = getIframeDocumentElement(node, this.options).then(function (documentElement) {\n                    return _this3.renderer(documentElement, {\n                        async: _this3.options.async,\n                        allowTaint: _this3.options.allowTaint,\n                        backgroundColor: '#ffffff',\n                        canvas: null,\n                        imageTimeout: _this3.options.imageTimeout,\n                        logging: _this3.options.logging,\n                        proxy: _this3.options.proxy,\n                        removeContainer: _this3.options.removeContainer,\n                        scale: _this3.options.scale,\n                        foreignObjectRendering: _this3.options.foreignObjectRendering,\n                        useCORS: _this3.options.useCORS,\n                        target: new _CanvasRenderer2.default(),\n                        width: width,\n                        height: height,\n                        x: 0,\n                        y: 0,\n                        windowWidth: documentElement.ownerDocument.defaultView.innerWidth,\n                        windowHeight: documentElement.ownerDocument.defaultView.innerHeight,\n                        scrollX: documentElement.ownerDocument.defaultView.pageXOffset,\n                        scrollY: documentElement.ownerDocument.defaultView.pageYOffset\n                    }, _this3.logger.child(iframeKey));\n                }).then(function (canvas) {\n                    return new Promise(function (resolve, reject) {\n                        var iframeCanvas = document.createElement('img');\n                        iframeCanvas.onload = function () {\n                            return resolve(canvas);\n                        };\n                        iframeCanvas.onerror = reject;\n                        iframeCanvas.src = canvas.toDataURL();\n                        if (tempIframe.parentNode) {\n                            tempIframe.parentNode.replaceChild((0, _Util.copyCSSStyles)(node.ownerDocument.defaultView.getComputedStyle(node), iframeCanvas), tempIframe);\n                        }\n                    });\n                });\n                return tempIframe;\n            }\n\n            if (node instanceof HTMLStyleElement && node.sheet && node.sheet.cssRules) {\n                var css = [].slice.call(node.sheet.cssRules, 0).reduce(function (css, rule) {\n                    try {\n                        if (rule && rule.cssText) {\n                            return css + rule.cssText;\n                        }\n                        return css;\n                    } catch (err) {\n                        _this3.logger.log('Unable to access cssText property', rule.name);\n                        return css;\n                    }\n                }, '');\n                var style = node.cloneNode(false);\n                style.textContent = css;\n                return style;\n            }\n\n            return node.cloneNode(false);\n        }\n    }, {\n        key: 'cloneNode',\n        value: function cloneNode(node) {\n            var clone = node.nodeType === Node.TEXT_NODE ? document.createTextNode(node.nodeValue) : this.createElementClone(node);\n\n            var window = node.ownerDocument.defaultView;\n            var style = node instanceof window.HTMLElement ? window.getComputedStyle(node) : null;\n            var styleBefore = node instanceof window.HTMLElement ? window.getComputedStyle(node, ':before') : null;\n            var styleAfter = node instanceof window.HTMLElement ? window.getComputedStyle(node, ':after') : null;\n\n            if (this.referenceElement === node && clone instanceof window.HTMLElement) {\n                this.clonedReferenceElement = clone;\n            }\n\n            if (clone instanceof window.HTMLBodyElement) {\n                createPseudoHideStyles(clone);\n            }\n\n            var counters = (0, _PseudoNodeContent.parseCounterReset)(style, this.pseudoContentData);\n            var contentBefore = (0, _PseudoNodeContent.resolvePseudoContent)(node, styleBefore, this.pseudoContentData);\n\n            for (var child = node.firstChild; child; child = child.nextSibling) {\n                if (child.nodeType !== Node.ELEMENT_NODE || child.nodeName !== 'SCRIPT' &&\n                // $FlowFixMe\n                !child.hasAttribute(IGNORE_ATTRIBUTE) && (typeof this.options.ignoreElements !== 'function' ||\n                // $FlowFixMe\n                !this.options.ignoreElements(child))) {\n                    if (!this.copyStyles || child.nodeName !== 'STYLE') {\n                        clone.appendChild(this.cloneNode(child));\n                    }\n                }\n            }\n\n            var contentAfter = (0, _PseudoNodeContent.resolvePseudoContent)(node, styleAfter, this.pseudoContentData);\n            (0, _PseudoNodeContent.popCounters)(counters, this.pseudoContentData);\n\n            if (node instanceof window.HTMLElement && clone instanceof window.HTMLElement) {\n                if (styleBefore) {\n                    this.inlineAllImages(inlinePseudoElement(node, clone, styleBefore, contentBefore, PSEUDO_BEFORE));\n                }\n                if (styleAfter) {\n                    this.inlineAllImages(inlinePseudoElement(node, clone, styleAfter, contentAfter, PSEUDO_AFTER));\n                }\n                if (style && this.copyStyles && !(node instanceof HTMLIFrameElement)) {\n                    (0, _Util.copyCSSStyles)(style, clone);\n                }\n                this.inlineAllImages(clone);\n                if (node.scrollTop !== 0 || node.scrollLeft !== 0) {\n                    this.scrolledElements.push([clone, node.scrollLeft, node.scrollTop]);\n                }\n                switch (node.nodeName) {\n                    case 'CANVAS':\n                        if (!this.copyStyles) {\n                            cloneCanvasContents(node, clone);\n                        }\n                        break;\n                    case 'TEXTAREA':\n                    case 'SELECT':\n                        clone.value = node.value;\n                        break;\n                }\n            }\n            return clone;\n        }\n    }]);\n\n    return DocumentCloner;\n}();\n\nvar getSheetFonts = function getSheetFonts(sheet, document) {\n    // $FlowFixMe\n    return (sheet.cssRules ? Array.from(sheet.cssRules) : []).filter(function (rule) {\n        return rule.type === CSSRule.FONT_FACE_RULE;\n    }).map(function (rule) {\n        var src = (0, _background.parseBackgroundImage)(rule.style.getPropertyValue('src'));\n        var formats = [];\n        for (var i = 0; i < src.length; i++) {\n            if (src[i].method === 'url' && src[i + 1] && src[i + 1].method === 'format') {\n                var a = document.createElement('a');\n                a.href = src[i].args[0];\n                if (document.body) {\n                    document.body.appendChild(a);\n                }\n\n                var font = {\n                    src: a.href,\n                    format: src[i + 1].args[0]\n                };\n                formats.push(font);\n            }\n        }\n\n        return {\n            // TODO select correct format for browser),\n\n            formats: formats.filter(function (font) {\n                return (/^woff/i.test(font.format)\n                );\n            }),\n            fontFace: rule.style\n        };\n    }).filter(function (font) {\n        return font.formats.length;\n    });\n};\n\nvar createStyleSheetFontsFromText = function createStyleSheetFontsFromText(text, baseHref) {\n    var doc = document.implementation.createHTMLDocument('');\n    var base = document.createElement('base');\n    // $FlowFixMe\n    base.href = baseHref;\n    var style = document.createElement('style');\n\n    style.textContent = text;\n    if (doc.head) {\n        doc.head.appendChild(base);\n    }\n    if (doc.body) {\n        doc.body.appendChild(style);\n    }\n\n    return style.sheet ? getSheetFonts(style.sheet, doc) : [];\n};\n\nvar restoreOwnerScroll = function restoreOwnerScroll(ownerDocument, x, y) {\n    if (ownerDocument.defaultView && (x !== ownerDocument.defaultView.pageXOffset || y !== ownerDocument.defaultView.pageYOffset)) {\n        ownerDocument.defaultView.scrollTo(x, y);\n    }\n};\n\nvar cloneCanvasContents = function cloneCanvasContents(canvas, clonedCanvas) {\n    try {\n        if (clonedCanvas) {\n            clonedCanvas.width = canvas.width;\n            clonedCanvas.height = canvas.height;\n            var ctx = canvas.getContext('2d');\n            var clonedCtx = clonedCanvas.getContext('2d');\n            if (ctx) {\n                clonedCtx.putImageData(ctx.getImageData(0, 0, canvas.width, canvas.height), 0, 0);\n            } else {\n                clonedCtx.drawImage(canvas, 0, 0);\n            }\n        }\n    } catch (e) {}\n};\n\nvar inlinePseudoElement = function inlinePseudoElement(node, clone, style, contentItems, pseudoElt) {\n    if (!style || !style.content || style.content === 'none' || style.content === '-moz-alt-content' || style.display === 'none') {\n        return;\n    }\n\n    var anonymousReplacedElement = clone.ownerDocument.createElement('html2canvaspseudoelement');\n    (0, _Util.copyCSSStyles)(style, anonymousReplacedElement);\n\n    if (contentItems) {\n        var len = contentItems.length;\n        for (var i = 0; i < len; i++) {\n            var item = contentItems[i];\n            switch (item.type) {\n                case _PseudoNodeContent.PSEUDO_CONTENT_ITEM_TYPE.IMAGE:\n                    var img = clone.ownerDocument.createElement('img');\n                    img.src = (0, _background.parseBackgroundImage)('url(' + item.value + ')')[0].args[0];\n                    img.style.opacity = '1';\n                    anonymousReplacedElement.appendChild(img);\n                    break;\n                case _PseudoNodeContent.PSEUDO_CONTENT_ITEM_TYPE.TEXT:\n                    anonymousReplacedElement.appendChild(clone.ownerDocument.createTextNode(item.value));\n                    break;\n            }\n        }\n    }\n\n    anonymousReplacedElement.className = PSEUDO_HIDE_ELEMENT_CLASS_BEFORE + ' ' + PSEUDO_HIDE_ELEMENT_CLASS_AFTER;\n    clone.className += pseudoElt === PSEUDO_BEFORE ? ' ' + PSEUDO_HIDE_ELEMENT_CLASS_BEFORE : ' ' + PSEUDO_HIDE_ELEMENT_CLASS_AFTER;\n    if (pseudoElt === PSEUDO_BEFORE) {\n        clone.insertBefore(anonymousReplacedElement, clone.firstChild);\n    } else {\n        clone.appendChild(anonymousReplacedElement);\n    }\n\n    return anonymousReplacedElement;\n};\n\nvar URL_REGEXP = /^url\\((.+)\\)$/i;\nvar PSEUDO_BEFORE = ':before';\nvar PSEUDO_AFTER = ':after';\nvar PSEUDO_HIDE_ELEMENT_CLASS_BEFORE = '___html2canvas___pseudoelement_before';\nvar PSEUDO_HIDE_ELEMENT_CLASS_AFTER = '___html2canvas___pseudoelement_after';\n\nvar PSEUDO_HIDE_ELEMENT_STYLE = '{\\n    content: \"\" !important;\\n    display: none !important;\\n}';\n\nvar createPseudoHideStyles = function createPseudoHideStyles(body) {\n    createStyles(body, '.' + PSEUDO_HIDE_ELEMENT_CLASS_BEFORE + PSEUDO_BEFORE + PSEUDO_HIDE_ELEMENT_STYLE + '\\n         .' + PSEUDO_HIDE_ELEMENT_CLASS_AFTER + PSEUDO_AFTER + PSEUDO_HIDE_ELEMENT_STYLE);\n};\n\nvar createStyles = function createStyles(body, styles) {\n    var style = body.ownerDocument.createElement('style');\n    style.innerHTML = styles;\n    body.appendChild(style);\n};\n\nvar initNode = function initNode(_ref) {\n    var _ref2 = _slicedToArray(_ref, 3),\n        element = _ref2[0],\n        x = _ref2[1],\n        y = _ref2[2];\n\n    element.scrollLeft = x;\n    element.scrollTop = y;\n};\n\nvar generateIframeKey = function generateIframeKey() {\n    return Math.ceil(Date.now() + Math.random() * 10000000).toString(16);\n};\n\nvar DATA_URI_REGEXP = /^data:text\\/(.+);(base64)?,(.*)$/i;\n\nvar getIframeDocumentElement = function getIframeDocumentElement(node, options) {\n    try {\n        return Promise.resolve(node.contentWindow.document.documentElement);\n    } catch (e) {\n        return options.proxy ? (0, _Proxy.Proxy)(node.src, options).then(function (html) {\n            var match = html.match(DATA_URI_REGEXP);\n            if (!match) {\n                return Promise.reject();\n            }\n\n            return match[2] === 'base64' ? window.atob(decodeURIComponent(match[3])) : decodeURIComponent(match[3]);\n        }).then(function (html) {\n            return createIframeContainer(node.ownerDocument, (0, _Bounds.parseBounds)(node, 0, 0)).then(function (cloneIframeContainer) {\n                var cloneWindow = cloneIframeContainer.contentWindow;\n                var documentClone = cloneWindow.document;\n\n                documentClone.open();\n                documentClone.write(html);\n                var iframeLoad = iframeLoader(cloneIframeContainer).then(function () {\n                    return documentClone.documentElement;\n                });\n\n                documentClone.close();\n                return iframeLoad;\n            });\n        }) : Promise.reject();\n    }\n};\n\nvar createIframeContainer = function createIframeContainer(ownerDocument, bounds) {\n    var cloneIframeContainer = ownerDocument.createElement('iframe');\n\n    cloneIframeContainer.className = 'html2canvas-container';\n    cloneIframeContainer.style.visibility = 'hidden';\n    cloneIframeContainer.style.position = 'fixed';\n    cloneIframeContainer.style.left = '-10000px';\n    cloneIframeContainer.style.top = '0px';\n    cloneIframeContainer.style.border = '0';\n    cloneIframeContainer.width = bounds.width.toString();\n    cloneIframeContainer.height = bounds.height.toString();\n    cloneIframeContainer.scrolling = 'no'; // ios won't scroll without it\n    cloneIframeContainer.setAttribute(IGNORE_ATTRIBUTE, 'true');\n    if (!ownerDocument.body) {\n        return Promise.reject(process.env.NODE_ENV !== 'production' ? 'Body element not found in Document that is getting rendered' : '');\n    }\n\n    ownerDocument.body.appendChild(cloneIframeContainer);\n\n    return Promise.resolve(cloneIframeContainer);\n};\n\nvar iframeLoader = function iframeLoader(cloneIframeContainer) {\n    var cloneWindow = cloneIframeContainer.contentWindow;\n    var documentClone = cloneWindow.document;\n\n    return new Promise(function (resolve, reject) {\n        cloneWindow.onload = cloneIframeContainer.onload = documentClone.onreadystatechange = function () {\n            var interval = setInterval(function () {\n                if (documentClone.body.childNodes.length > 0 && documentClone.readyState === 'complete') {\n                    clearInterval(interval);\n                    resolve(cloneIframeContainer);\n                }\n            }, 50);\n        };\n    });\n};\n\nvar cloneWindow = exports.cloneWindow = function cloneWindow(ownerDocument, bounds, referenceElement, options, logger, renderer) {\n    var cloner = new DocumentCloner(referenceElement, options, logger, false, renderer);\n    var scrollX = ownerDocument.defaultView.pageXOffset;\n    var scrollY = ownerDocument.defaultView.pageYOffset;\n\n    return createIframeContainer(ownerDocument, bounds).then(function (cloneIframeContainer) {\n        var cloneWindow = cloneIframeContainer.contentWindow;\n        var documentClone = cloneWindow.document;\n\n        /* Chrome doesn't detect relative background-images assigned in inline <style> sheets when fetched through getComputedStyle\n             if window url is about:blank, we can assign the url to current by writing onto the document\n             */\n\n        var iframeLoad = iframeLoader(cloneIframeContainer).then(function () {\n            cloner.scrolledElements.forEach(initNode);\n            cloneWindow.scrollTo(bounds.left, bounds.top);\n            if (/(iPad|iPhone|iPod)/g.test(navigator.userAgent) && (cloneWindow.scrollY !== bounds.top || cloneWindow.scrollX !== bounds.left)) {\n                documentClone.documentElement.style.top = -bounds.top + 'px';\n                documentClone.documentElement.style.left = -bounds.left + 'px';\n                documentClone.documentElement.style.position = 'absolute';\n            }\n\n            var result = Promise.resolve([cloneIframeContainer, cloner.clonedReferenceElement, cloner.resourceLoader]);\n\n            var onclone = options.onclone;\n\n            return cloner.clonedReferenceElement instanceof cloneWindow.HTMLElement || cloner.clonedReferenceElement instanceof ownerDocument.defaultView.HTMLElement || cloner.clonedReferenceElement instanceof HTMLElement ? typeof onclone === 'function' ? Promise.resolve().then(function () {\n                return onclone(documentClone);\n            }).then(function () {\n                return result;\n            }) : result : Promise.reject(process.env.NODE_ENV !== 'production' ? 'Error finding the ' + referenceElement.nodeName + ' in the cloned document' : '');\n        });\n\n        documentClone.open();\n        documentClone.write(serializeDoctype(document.doctype) + '<html></html>');\n        // Chrome scrolls the parent document for some reason after the write to the cloned window???\n        restoreOwnerScroll(referenceElement.ownerDocument, scrollX, scrollY);\n        documentClone.replaceChild(documentClone.adoptNode(cloner.documentElement), documentClone.documentElement);\n        documentClone.close();\n\n        return iframeLoad;\n    });\n};\n\nvar serializeDoctype = function serializeDoctype(doctype) {\n    var str = '';\n    if (doctype) {\n        str += '<!DOCTYPE ';\n        if (doctype.name) {\n            str += doctype.name;\n        }\n\n        if (doctype.internalSubset) {\n            str += doctype.internalSubset;\n        }\n\n        if (doctype.publicId) {\n            str += '\"' + doctype.publicId + '\"';\n        }\n\n        if (doctype.systemId) {\n            str += '\"' + doctype.systemId + '\"';\n        }\n\n        str += '>';\n    }\n\n    return str;\n};"]},"metadata":{},"sourceType":"script"}