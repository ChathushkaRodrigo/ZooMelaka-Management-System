{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _slicedToArray = function () {\n  function sliceIterator(arr, i) {\n    var _arr = [];\n    var _n = true;\n    var _d = false;\n    var _e = undefined;\n\n    try {\n      for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n        _arr.push(_s.value);\n\n        if (i && _arr.length === i) break;\n      }\n    } catch (err) {\n      _d = true;\n      _e = err;\n    } finally {\n      try {\n        if (!_n && _i[\"return\"]) _i[\"return\"]();\n      } finally {\n        if (_d) throw _e;\n      }\n    }\n\n    return _arr;\n  }\n\n  return function (arr, i) {\n    if (Array.isArray(arr)) {\n      return arr;\n    } else if (Symbol.iterator in Object(arr)) {\n      return sliceIterator(arr, i);\n    } else {\n      throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n    }\n  };\n}();\n\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nvar _Bounds = require('./Bounds');\n\nvar _Font = require('./Font');\n\nvar _Gradient = require('./Gradient');\n\nvar _TextContainer = require('./TextContainer');\n\nvar _TextContainer2 = _interopRequireDefault(_TextContainer);\n\nvar _background = require('./parsing/background');\n\nvar _border = require('./parsing/border');\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nvar Renderer = function () {\n  function Renderer(target, options) {\n    _classCallCheck(this, Renderer);\n\n    this.target = target;\n    this.options = options;\n    target.render(options);\n  }\n\n  _createClass(Renderer, [{\n    key: 'renderNode',\n    value: function renderNode(container) {\n      if (container.isVisible()) {\n        this.renderNodeBackgroundAndBorders(container);\n        this.renderNodeContent(container);\n      }\n    }\n  }, {\n    key: 'renderNodeContent',\n    value: function renderNodeContent(container) {\n      var _this = this;\n\n      var callback = function callback() {\n        if (container.childNodes.length) {\n          container.childNodes.forEach(function (child) {\n            if (child instanceof _TextContainer2.default) {\n              var style = child.parent.style;\n\n              _this.target.renderTextNode(child.bounds, style.color, style.font, style.textDecoration, style.textShadow);\n            } else {\n              _this.target.drawShape(child, container.style.color);\n            }\n          });\n        }\n\n        if (container.image) {\n          var _image = _this.options.imageStore.get(container.image);\n\n          if (_image) {\n            var contentBox = (0, _Bounds.calculateContentBox)(container.bounds, container.style.padding, container.style.border);\n\n            var _width = typeof _image.width === 'number' && _image.width > 0 ? _image.width : contentBox.width;\n\n            var _height = typeof _image.height === 'number' && _image.height > 0 ? _image.height : contentBox.height;\n\n            if (_width > 0 && _height > 0) {\n              _this.target.clip([(0, _Bounds.calculatePaddingBoxPath)(container.curvedBounds)], function () {\n                _this.target.drawImage(_image, new _Bounds.Bounds(0, 0, _width, _height), contentBox);\n              });\n            }\n          }\n        }\n      };\n\n      var paths = container.getClipPaths();\n\n      if (paths.length) {\n        this.target.clip(paths, callback);\n      } else {\n        callback();\n      }\n    }\n  }, {\n    key: 'renderNodeBackgroundAndBorders',\n    value: function renderNodeBackgroundAndBorders(container) {\n      var _this2 = this;\n\n      var HAS_BACKGROUND = !container.style.background.backgroundColor.isTransparent() || container.style.background.backgroundImage.length;\n      var hasRenderableBorders = container.style.border.some(function (border) {\n        return border.borderStyle !== _border.BORDER_STYLE.NONE && !border.borderColor.isTransparent();\n      });\n\n      var callback = function callback() {\n        var backgroundPaintingArea = (0, _background.calculateBackgroungPaintingArea)(container.curvedBounds, container.style.background.backgroundClip);\n\n        if (HAS_BACKGROUND) {\n          _this2.target.clip([backgroundPaintingArea], function () {\n            if (!container.style.background.backgroundColor.isTransparent()) {\n              _this2.target.fill(container.style.background.backgroundColor);\n            }\n\n            _this2.renderBackgroundImage(container);\n          });\n        }\n\n        container.style.border.forEach(function (border, side) {\n          if (border.borderStyle !== _border.BORDER_STYLE.NONE && !border.borderColor.isTransparent()) {\n            _this2.renderBorder(border, side, container.curvedBounds);\n          }\n        });\n      };\n\n      if (HAS_BACKGROUND || hasRenderableBorders) {\n        var paths = container.parent ? container.parent.getClipPaths() : [];\n\n        if (paths.length) {\n          this.target.clip(paths, callback);\n        } else {\n          callback();\n        }\n      }\n    }\n  }, {\n    key: 'renderBackgroundImage',\n    value: function renderBackgroundImage(container) {\n      var _this3 = this;\n\n      container.style.background.backgroundImage.slice(0).reverse().forEach(function (backgroundImage) {\n        if (backgroundImage.source.method === 'url' && backgroundImage.source.args.length) {\n          _this3.renderBackgroundRepeat(container, backgroundImage);\n        } else if (/gradient/i.test(backgroundImage.source.method)) {\n          _this3.renderBackgroundGradient(container, backgroundImage);\n        }\n      });\n    }\n  }, {\n    key: 'renderBackgroundRepeat',\n    value: function renderBackgroundRepeat(container, background) {\n      var image = this.options.imageStore.get(background.source.args[0]);\n\n      if (image) {\n        var backgroundPositioningArea = (0, _background.calculateBackgroungPositioningArea)(container.style.background.backgroundOrigin, container.bounds, container.style.padding, container.style.border);\n        var backgroundImageSize = (0, _background.calculateBackgroundSize)(background, image, backgroundPositioningArea);\n        var position = (0, _background.calculateBackgroundPosition)(background.position, backgroundImageSize, backgroundPositioningArea);\n\n        var _path = (0, _background.calculateBackgroundRepeatPath)(background, position, backgroundImageSize, backgroundPositioningArea, container.bounds);\n\n        var _offsetX = Math.round(backgroundPositioningArea.left + position.x);\n\n        var _offsetY = Math.round(backgroundPositioningArea.top + position.y);\n\n        this.target.renderRepeat(_path, image, backgroundImageSize, _offsetX, _offsetY);\n      }\n    }\n  }, {\n    key: 'renderBackgroundGradient',\n    value: function renderBackgroundGradient(container, background) {\n      var backgroundPositioningArea = (0, _background.calculateBackgroungPositioningArea)(container.style.background.backgroundOrigin, container.bounds, container.style.padding, container.style.border);\n      var backgroundImageSize = (0, _background.calculateGradientBackgroundSize)(background, backgroundPositioningArea);\n      var position = (0, _background.calculateBackgroundPosition)(background.position, backgroundImageSize, backgroundPositioningArea);\n      var gradientBounds = new _Bounds.Bounds(Math.round(backgroundPositioningArea.left + position.x), Math.round(backgroundPositioningArea.top + position.y), backgroundImageSize.width, backgroundImageSize.height);\n      var gradient = (0, _Gradient.parseGradient)(container, background.source, gradientBounds);\n\n      if (gradient) {\n        switch (gradient.type) {\n          case _Gradient.GRADIENT_TYPE.LINEAR_GRADIENT:\n            // $FlowFixMe\n            this.target.renderLinearGradient(gradientBounds, gradient);\n            break;\n\n          case _Gradient.GRADIENT_TYPE.RADIAL_GRADIENT:\n            // $FlowFixMe\n            this.target.renderRadialGradient(gradientBounds, gradient);\n            break;\n        }\n      }\n    }\n  }, {\n    key: 'renderBorder',\n    value: function renderBorder(border, side, curvePoints) {\n      this.target.drawShape((0, _Bounds.parsePathForBorder)(curvePoints, side), border.borderColor);\n    }\n  }, {\n    key: 'renderStack',\n    value: function renderStack(stack) {\n      var _this4 = this;\n\n      if (stack.container.isVisible()) {\n        var _opacity = stack.getOpacity();\n\n        if (_opacity !== this._opacity) {\n          this.target.setOpacity(stack.getOpacity());\n          this._opacity = _opacity;\n        }\n\n        var _transform = stack.container.style.transform;\n\n        if (_transform !== null) {\n          this.target.transform(stack.container.bounds.left + _transform.transformOrigin[0].value, stack.container.bounds.top + _transform.transformOrigin[1].value, _transform.transform, function () {\n            return _this4.renderStackContent(stack);\n          });\n        } else {\n          this.renderStackContent(stack);\n        }\n      }\n    }\n  }, {\n    key: 'renderStackContent',\n    value: function renderStackContent(stack) {\n      var _splitStackingContext = splitStackingContexts(stack),\n          _splitStackingContext2 = _slicedToArray(_splitStackingContext, 5),\n          negativeZIndex = _splitStackingContext2[0],\n          zeroOrAutoZIndexOrTransformedOrOpacity = _splitStackingContext2[1],\n          positiveZIndex = _splitStackingContext2[2],\n          nonPositionedFloats = _splitStackingContext2[3],\n          nonPositionedInlineLevel = _splitStackingContext2[4];\n\n      var _splitDescendants = splitDescendants(stack),\n          _splitDescendants2 = _slicedToArray(_splitDescendants, 2),\n          inlineLevel = _splitDescendants2[0],\n          nonInlineLevel = _splitDescendants2[1]; // https://www.w3.org/TR/css-position-3/#painting-order\n      // 1. the background and borders of the element forming the stacking context.\n\n\n      this.renderNodeBackgroundAndBorders(stack.container); // 2. the child stacking contexts with negative stack levels (most negative first).\n\n      negativeZIndex.sort(sortByZIndex).forEach(this.renderStack, this); // 3. For all its in-flow, non-positioned, block-level descendants in tree order:\n\n      this.renderNodeContent(stack.container);\n      nonInlineLevel.forEach(this.renderNode, this); // 4. All non-positioned floating descendants, in tree order. For each one of these,\n      // treat the element as if it created a new stacking context, but any positioned descendants and descendants\n      // which actually create a new stacking context should be considered part of the parent stacking context,\n      // not this new one.\n\n      nonPositionedFloats.forEach(this.renderStack, this); // 5. the in-flow, inline-level, non-positioned descendants, including inline tables and inline blocks.\n\n      nonPositionedInlineLevel.forEach(this.renderStack, this);\n      inlineLevel.forEach(this.renderNode, this); // 6. All positioned, opacity or transform descendants, in tree order that fall into the following categories:\n      //  All positioned descendants with 'z-index: auto' or 'z-index: 0', in tree order.\n      //  For those with 'z-index: auto', treat the element as if it created a new stacking context,\n      //  but any positioned descendants and descendants which actually create a new stacking context should be\n      //  considered part of the parent stacking context, not this new one. For those with 'z-index: 0',\n      //  treat the stacking context generated atomically.\n      //\n      //  All opacity descendants with opacity less than 1\n      //\n      //  All transform descendants with transform other than none\n\n      zeroOrAutoZIndexOrTransformedOrOpacity.forEach(this.renderStack, this); // 7. Stacking contexts formed by positioned descendants with z-indices greater than or equal to 1 in z-index\n      // order (smallest first) then tree order.\n\n      positiveZIndex.sort(sortByZIndex).forEach(this.renderStack, this);\n    }\n  }, {\n    key: 'render',\n    value: function render(stack) {\n      var _this5 = this;\n\n      if (this.options.backgroundColor) {\n        this.target.rectangle(this.options.x, this.options.y, this.options.width, this.options.height, this.options.backgroundColor);\n      }\n\n      this.renderStack(stack);\n      var target = this.target.getTarget();\n\n      if (process.env.NODE_ENV !== 'production') {\n        return target.then(function (output) {\n          _this5.options.logger.log('Render completed');\n\n          return output;\n        });\n      }\n\n      return target;\n    }\n  }]);\n\n  return Renderer;\n}();\n\nexports.default = Renderer;\n\nvar splitDescendants = function splitDescendants(stack) {\n  var inlineLevel = [];\n  var nonInlineLevel = [];\n  var length = stack.children.length;\n\n  for (var i = 0; i < length; i++) {\n    var child = stack.children[i];\n\n    if (child.isInlineLevel()) {\n      inlineLevel.push(child);\n    } else {\n      nonInlineLevel.push(child);\n    }\n  }\n\n  return [inlineLevel, nonInlineLevel];\n};\n\nvar splitStackingContexts = function splitStackingContexts(stack) {\n  var negativeZIndex = [];\n  var zeroOrAutoZIndexOrTransformedOrOpacity = [];\n  var positiveZIndex = [];\n  var nonPositionedFloats = [];\n  var nonPositionedInlineLevel = [];\n  var length = stack.contexts.length;\n\n  for (var i = 0; i < length; i++) {\n    var child = stack.contexts[i];\n\n    if (child.container.isPositioned() || child.container.style.opacity < 1 || child.container.isTransformed()) {\n      if (child.container.style.zIndex.order < 0) {\n        negativeZIndex.push(child);\n      } else if (child.container.style.zIndex.order > 0) {\n        positiveZIndex.push(child);\n      } else {\n        zeroOrAutoZIndexOrTransformedOrOpacity.push(child);\n      }\n    } else {\n      if (child.container.isFloating()) {\n        nonPositionedFloats.push(child);\n      } else {\n        nonPositionedInlineLevel.push(child);\n      }\n    }\n  }\n\n  return [negativeZIndex, zeroOrAutoZIndexOrTransformedOrOpacity, positiveZIndex, nonPositionedFloats, nonPositionedInlineLevel];\n};\n\nvar sortByZIndex = function sortByZIndex(a, b) {\n  if (a.container.style.zIndex.order > b.container.style.zIndex.order) {\n    return 1;\n  } else if (a.container.style.zIndex.order < b.container.style.zIndex.order) {\n    return -1;\n  }\n\n  return a.container.index > b.container.index ? 1 : -1;\n};","map":{"version":3,"sources":["/Users/ChathushkaRodrigo/Desktop/ITP Project/ZooMelaka-Management-System/frontend/node_modules/react-to-pdf/node_modules/html2canvas/dist/npm/Renderer.js"],"names":["Object","defineProperty","exports","value","_slicedToArray","sliceIterator","arr","i","_arr","_n","_d","_e","undefined","_i","Symbol","iterator","_s","next","done","push","length","err","Array","isArray","TypeError","_createClass","defineProperties","target","props","descriptor","enumerable","configurable","writable","key","Constructor","protoProps","staticProps","prototype","_Bounds","require","_Font","_Gradient","_TextContainer","_TextContainer2","_interopRequireDefault","_background","_border","obj","__esModule","default","_classCallCheck","instance","Renderer","options","render","renderNode","container","isVisible","renderNodeBackgroundAndBorders","renderNodeContent","_this","callback","childNodes","forEach","child","style","parent","renderTextNode","bounds","color","font","textDecoration","textShadow","drawShape","image","_image","imageStore","get","contentBox","calculateContentBox","padding","border","_width","width","_height","height","clip","calculatePaddingBoxPath","curvedBounds","drawImage","Bounds","paths","getClipPaths","_this2","HAS_BACKGROUND","background","backgroundColor","isTransparent","backgroundImage","hasRenderableBorders","some","borderStyle","BORDER_STYLE","NONE","borderColor","backgroundPaintingArea","calculateBackgroungPaintingArea","backgroundClip","fill","renderBackgroundImage","side","renderBorder","_this3","slice","reverse","source","method","args","renderBackgroundRepeat","test","renderBackgroundGradient","backgroundPositioningArea","calculateBackgroungPositioningArea","backgroundOrigin","backgroundImageSize","calculateBackgroundSize","position","calculateBackgroundPosition","_path","calculateBackgroundRepeatPath","_offsetX","Math","round","left","x","_offsetY","top","y","renderRepeat","calculateGradientBackgroundSize","gradientBounds","gradient","parseGradient","type","GRADIENT_TYPE","LINEAR_GRADIENT","renderLinearGradient","RADIAL_GRADIENT","renderRadialGradient","curvePoints","parsePathForBorder","renderStack","stack","_this4","_opacity","getOpacity","setOpacity","_transform","transform","transformOrigin","renderStackContent","_splitStackingContext","splitStackingContexts","_splitStackingContext2","negativeZIndex","zeroOrAutoZIndexOrTransformedOrOpacity","positiveZIndex","nonPositionedFloats","nonPositionedInlineLevel","_splitDescendants","splitDescendants","_splitDescendants2","inlineLevel","nonInlineLevel","sort","sortByZIndex","_this5","rectangle","getTarget","process","env","NODE_ENV","then","output","logger","log","children","isInlineLevel","contexts","isPositioned","opacity","isTransformed","zIndex","order","isFloating","a","b","index"],"mappings":"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","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _Bounds = require('./Bounds');\n\nvar _Font = require('./Font');\n\nvar _Gradient = require('./Gradient');\n\nvar _TextContainer = require('./TextContainer');\n\nvar _TextContainer2 = _interopRequireDefault(_TextContainer);\n\nvar _background = require('./parsing/background');\n\nvar _border = require('./parsing/border');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Renderer = function () {\n    function Renderer(target, options) {\n        _classCallCheck(this, Renderer);\n\n        this.target = target;\n        this.options = options;\n        target.render(options);\n    }\n\n    _createClass(Renderer, [{\n        key: 'renderNode',\n        value: function renderNode(container) {\n            if (container.isVisible()) {\n                this.renderNodeBackgroundAndBorders(container);\n                this.renderNodeContent(container);\n            }\n        }\n    }, {\n        key: 'renderNodeContent',\n        value: function renderNodeContent(container) {\n            var _this = this;\n\n            var callback = function callback() {\n                if (container.childNodes.length) {\n                    container.childNodes.forEach(function (child) {\n                        if (child instanceof _TextContainer2.default) {\n                            var style = child.parent.style;\n                            _this.target.renderTextNode(child.bounds, style.color, style.font, style.textDecoration, style.textShadow);\n                        } else {\n                            _this.target.drawShape(child, container.style.color);\n                        }\n                    });\n                }\n\n                if (container.image) {\n                    var _image = _this.options.imageStore.get(container.image);\n                    if (_image) {\n                        var contentBox = (0, _Bounds.calculateContentBox)(container.bounds, container.style.padding, container.style.border);\n                        var _width = typeof _image.width === 'number' && _image.width > 0 ? _image.width : contentBox.width;\n                        var _height = typeof _image.height === 'number' && _image.height > 0 ? _image.height : contentBox.height;\n                        if (_width > 0 && _height > 0) {\n                            _this.target.clip([(0, _Bounds.calculatePaddingBoxPath)(container.curvedBounds)], function () {\n                                _this.target.drawImage(_image, new _Bounds.Bounds(0, 0, _width, _height), contentBox);\n                            });\n                        }\n                    }\n                }\n            };\n            var paths = container.getClipPaths();\n            if (paths.length) {\n                this.target.clip(paths, callback);\n            } else {\n                callback();\n            }\n        }\n    }, {\n        key: 'renderNodeBackgroundAndBorders',\n        value: function renderNodeBackgroundAndBorders(container) {\n            var _this2 = this;\n\n            var HAS_BACKGROUND = !container.style.background.backgroundColor.isTransparent() || container.style.background.backgroundImage.length;\n\n            var hasRenderableBorders = container.style.border.some(function (border) {\n                return border.borderStyle !== _border.BORDER_STYLE.NONE && !border.borderColor.isTransparent();\n            });\n\n            var callback = function callback() {\n                var backgroundPaintingArea = (0, _background.calculateBackgroungPaintingArea)(container.curvedBounds, container.style.background.backgroundClip);\n\n                if (HAS_BACKGROUND) {\n                    _this2.target.clip([backgroundPaintingArea], function () {\n                        if (!container.style.background.backgroundColor.isTransparent()) {\n                            _this2.target.fill(container.style.background.backgroundColor);\n                        }\n\n                        _this2.renderBackgroundImage(container);\n                    });\n                }\n\n                container.style.border.forEach(function (border, side) {\n                    if (border.borderStyle !== _border.BORDER_STYLE.NONE && !border.borderColor.isTransparent()) {\n                        _this2.renderBorder(border, side, container.curvedBounds);\n                    }\n                });\n            };\n\n            if (HAS_BACKGROUND || hasRenderableBorders) {\n                var paths = container.parent ? container.parent.getClipPaths() : [];\n                if (paths.length) {\n                    this.target.clip(paths, callback);\n                } else {\n                    callback();\n                }\n            }\n        }\n    }, {\n        key: 'renderBackgroundImage',\n        value: function renderBackgroundImage(container) {\n            var _this3 = this;\n\n            container.style.background.backgroundImage.slice(0).reverse().forEach(function (backgroundImage) {\n                if (backgroundImage.source.method === 'url' && backgroundImage.source.args.length) {\n                    _this3.renderBackgroundRepeat(container, backgroundImage);\n                } else if (/gradient/i.test(backgroundImage.source.method)) {\n                    _this3.renderBackgroundGradient(container, backgroundImage);\n                }\n            });\n        }\n    }, {\n        key: 'renderBackgroundRepeat',\n        value: function renderBackgroundRepeat(container, background) {\n            var image = this.options.imageStore.get(background.source.args[0]);\n            if (image) {\n                var backgroundPositioningArea = (0, _background.calculateBackgroungPositioningArea)(container.style.background.backgroundOrigin, container.bounds, container.style.padding, container.style.border);\n                var backgroundImageSize = (0, _background.calculateBackgroundSize)(background, image, backgroundPositioningArea);\n                var position = (0, _background.calculateBackgroundPosition)(background.position, backgroundImageSize, backgroundPositioningArea);\n                var _path = (0, _background.calculateBackgroundRepeatPath)(background, position, backgroundImageSize, backgroundPositioningArea, container.bounds);\n\n                var _offsetX = Math.round(backgroundPositioningArea.left + position.x);\n                var _offsetY = Math.round(backgroundPositioningArea.top + position.y);\n                this.target.renderRepeat(_path, image, backgroundImageSize, _offsetX, _offsetY);\n            }\n        }\n    }, {\n        key: 'renderBackgroundGradient',\n        value: function renderBackgroundGradient(container, background) {\n            var backgroundPositioningArea = (0, _background.calculateBackgroungPositioningArea)(container.style.background.backgroundOrigin, container.bounds, container.style.padding, container.style.border);\n            var backgroundImageSize = (0, _background.calculateGradientBackgroundSize)(background, backgroundPositioningArea);\n            var position = (0, _background.calculateBackgroundPosition)(background.position, backgroundImageSize, backgroundPositioningArea);\n            var gradientBounds = new _Bounds.Bounds(Math.round(backgroundPositioningArea.left + position.x), Math.round(backgroundPositioningArea.top + position.y), backgroundImageSize.width, backgroundImageSize.height);\n\n            var gradient = (0, _Gradient.parseGradient)(container, background.source, gradientBounds);\n            if (gradient) {\n                switch (gradient.type) {\n                    case _Gradient.GRADIENT_TYPE.LINEAR_GRADIENT:\n                        // $FlowFixMe\n                        this.target.renderLinearGradient(gradientBounds, gradient);\n                        break;\n                    case _Gradient.GRADIENT_TYPE.RADIAL_GRADIENT:\n                        // $FlowFixMe\n                        this.target.renderRadialGradient(gradientBounds, gradient);\n                        break;\n                }\n            }\n        }\n    }, {\n        key: 'renderBorder',\n        value: function renderBorder(border, side, curvePoints) {\n            this.target.drawShape((0, _Bounds.parsePathForBorder)(curvePoints, side), border.borderColor);\n        }\n    }, {\n        key: 'renderStack',\n        value: function renderStack(stack) {\n            var _this4 = this;\n\n            if (stack.container.isVisible()) {\n                var _opacity = stack.getOpacity();\n                if (_opacity !== this._opacity) {\n                    this.target.setOpacity(stack.getOpacity());\n                    this._opacity = _opacity;\n                }\n\n                var _transform = stack.container.style.transform;\n                if (_transform !== null) {\n                    this.target.transform(stack.container.bounds.left + _transform.transformOrigin[0].value, stack.container.bounds.top + _transform.transformOrigin[1].value, _transform.transform, function () {\n                        return _this4.renderStackContent(stack);\n                    });\n                } else {\n                    this.renderStackContent(stack);\n                }\n            }\n        }\n    }, {\n        key: 'renderStackContent',\n        value: function renderStackContent(stack) {\n            var _splitStackingContext = splitStackingContexts(stack),\n                _splitStackingContext2 = _slicedToArray(_splitStackingContext, 5),\n                negativeZIndex = _splitStackingContext2[0],\n                zeroOrAutoZIndexOrTransformedOrOpacity = _splitStackingContext2[1],\n                positiveZIndex = _splitStackingContext2[2],\n                nonPositionedFloats = _splitStackingContext2[3],\n                nonPositionedInlineLevel = _splitStackingContext2[4];\n\n            var _splitDescendants = splitDescendants(stack),\n                _splitDescendants2 = _slicedToArray(_splitDescendants, 2),\n                inlineLevel = _splitDescendants2[0],\n                nonInlineLevel = _splitDescendants2[1];\n\n            // https://www.w3.org/TR/css-position-3/#painting-order\n            // 1. the background and borders of the element forming the stacking context.\n\n\n            this.renderNodeBackgroundAndBorders(stack.container);\n            // 2. the child stacking contexts with negative stack levels (most negative first).\n            negativeZIndex.sort(sortByZIndex).forEach(this.renderStack, this);\n            // 3. For all its in-flow, non-positioned, block-level descendants in tree order:\n            this.renderNodeContent(stack.container);\n            nonInlineLevel.forEach(this.renderNode, this);\n            // 4. All non-positioned floating descendants, in tree order. For each one of these,\n            // treat the element as if it created a new stacking context, but any positioned descendants and descendants\n            // which actually create a new stacking context should be considered part of the parent stacking context,\n            // not this new one.\n            nonPositionedFloats.forEach(this.renderStack, this);\n            // 5. the in-flow, inline-level, non-positioned descendants, including inline tables and inline blocks.\n            nonPositionedInlineLevel.forEach(this.renderStack, this);\n            inlineLevel.forEach(this.renderNode, this);\n            // 6. All positioned, opacity or transform descendants, in tree order that fall into the following categories:\n            //  All positioned descendants with 'z-index: auto' or 'z-index: 0', in tree order.\n            //  For those with 'z-index: auto', treat the element as if it created a new stacking context,\n            //  but any positioned descendants and descendants which actually create a new stacking context should be\n            //  considered part of the parent stacking context, not this new one. For those with 'z-index: 0',\n            //  treat the stacking context generated atomically.\n            //\n            //  All opacity descendants with opacity less than 1\n            //\n            //  All transform descendants with transform other than none\n            zeroOrAutoZIndexOrTransformedOrOpacity.forEach(this.renderStack, this);\n            // 7. Stacking contexts formed by positioned descendants with z-indices greater than or equal to 1 in z-index\n            // order (smallest first) then tree order.\n            positiveZIndex.sort(sortByZIndex).forEach(this.renderStack, this);\n        }\n    }, {\n        key: 'render',\n        value: function render(stack) {\n            var _this5 = this;\n\n            if (this.options.backgroundColor) {\n                this.target.rectangle(this.options.x, this.options.y, this.options.width, this.options.height, this.options.backgroundColor);\n            }\n            this.renderStack(stack);\n            var target = this.target.getTarget();\n            if (process.env.NODE_ENV !== 'production') {\n                return target.then(function (output) {\n                    _this5.options.logger.log('Render completed');\n                    return output;\n                });\n            }\n            return target;\n        }\n    }]);\n\n    return Renderer;\n}();\n\nexports.default = Renderer;\n\n\nvar splitDescendants = function splitDescendants(stack) {\n    var inlineLevel = [];\n    var nonInlineLevel = [];\n\n    var length = stack.children.length;\n    for (var i = 0; i < length; i++) {\n        var child = stack.children[i];\n        if (child.isInlineLevel()) {\n            inlineLevel.push(child);\n        } else {\n            nonInlineLevel.push(child);\n        }\n    }\n    return [inlineLevel, nonInlineLevel];\n};\n\nvar splitStackingContexts = function splitStackingContexts(stack) {\n    var negativeZIndex = [];\n    var zeroOrAutoZIndexOrTransformedOrOpacity = [];\n    var positiveZIndex = [];\n    var nonPositionedFloats = [];\n    var nonPositionedInlineLevel = [];\n    var length = stack.contexts.length;\n    for (var i = 0; i < length; i++) {\n        var child = stack.contexts[i];\n        if (child.container.isPositioned() || child.container.style.opacity < 1 || child.container.isTransformed()) {\n            if (child.container.style.zIndex.order < 0) {\n                negativeZIndex.push(child);\n            } else if (child.container.style.zIndex.order > 0) {\n                positiveZIndex.push(child);\n            } else {\n                zeroOrAutoZIndexOrTransformedOrOpacity.push(child);\n            }\n        } else {\n            if (child.container.isFloating()) {\n                nonPositionedFloats.push(child);\n            } else {\n                nonPositionedInlineLevel.push(child);\n            }\n        }\n    }\n    return [negativeZIndex, zeroOrAutoZIndexOrTransformedOrOpacity, positiveZIndex, nonPositionedFloats, nonPositionedInlineLevel];\n};\n\nvar sortByZIndex = function sortByZIndex(a, b) {\n    if (a.container.style.zIndex.order > b.container.style.zIndex.order) {\n        return 1;\n    } else if (a.container.style.zIndex.order < b.container.style.zIndex.order) {\n        return -1;\n    }\n\n    return a.container.index > b.container.index ? 1 : -1;\n};"]},"metadata":{},"sourceType":"script"}